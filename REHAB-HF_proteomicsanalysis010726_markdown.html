<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>rehab-hf_proteomicsanalysis010726_markdown</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/clipboard/clipboard.min.js"></script>
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/popper.min.js"></script>
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/anchor.min.js"></script>
<link href="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="REHAB-HF_proteomicsanalysis010726_markdown_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<div class="sourceCode" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "REHAB-HF Proteomics Analysis"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Protein Biomarkers and Rehabilitation Outcomes in Heart Failure with Preserved Ejection Fraction"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Scott Bruce"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2026-01-07"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> pdf</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="setup-and-configuration" class="level1">
<h1>Setup and Configuration</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   4.0.1     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XLConnect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>XLConnect 1.2.2 by Mirai Solutions GmbH [aut],
  Martin Studer [cre] (ORCID: &lt;https://orcid.org/0009-0004-8250-7303&gt;),
  The Apache Software Foundation [ctb, cph] (Apache POI),
  Graph Builder [ctb, cph] (Curvesapi Java library),
  Brett Woolridge [ctb, cph] (SparseBitSet Java library)
https://mirai-solutions.ch
https://github.com/miraisolutions/xlconnect</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'janitor' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gt' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gtsummary' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reshape2' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'

The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sjPlot'

The following object is masked from 'package:ggplot2':

    set_theme</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glinternet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glinternet' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glinternet 1.0.12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bartMachine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'bartMachine' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rJava</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rJava' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: bartMachineJARs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'bartMachineJARs' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: randomForest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'randomForest' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2
Type rfNews() to see new features/changes/bug fixes.

Attaching package: 'randomForest'

The following object is masked from 'package:gridExtra':

    combine

The following object is masked from 'package:dplyr':

    combine

The following object is masked from 'package:ggplot2':

    margin

Loading required package: missForest
Welcome to bartMachine v1.3.4.1! You have 0.51GB memory available.

If you run out of memory, restart R, and use e.g.
'options(java.parameters = "-Xmx5g")' for 5GB of RAM before you call
'library(bartMachine)'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(optmatch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'optmatch' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lsmeans' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: emmeans
Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'
The 'lsmeans' package is now basically a front end for 'emmeans'.
Users are encouraged to switch the rest of the way.
See help('transition') for more information, including how to
convert old 'lsmeans' objects and scripts to work with 'emmeans'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treeClust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: cluster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdfCluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pdfCluster' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>pdfCluster 1.0-4

Attaching package: 'pdfCluster'

The following object is masked from 'package:dplyr':

    groups</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:gtsummary':

    select

The following object is masked from 'package:dplyr':

    select

Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loading required package: mvtnorm
Loading required package: sandwich
mediation: Causal Mediation Analysis
Version: 4.5.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggcorrplot' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HDtest)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WGCNA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'WGCNA' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: dynamicTreeCut</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dynamicTreeCut' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: fastcluster

Attaching package: 'fastcluster'

The following object is masked from 'package:stats':

    hclust



Attaching package: 'WGCNA'

The following object is masked from 'package:stats':

    cor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggrepel' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="data-dictionary">Data Dictionary</h2>
<p>This analysis includes the following variables:</p>
<p><strong>Demographic/Clinical Variables:</strong> - <code>age</code>: Age in years - <code>sex</code>: 1=female, 0=male - <code>race___4</code>: 1=white, 0=non-white - <code>hf_cat</code>: 1=HFpEF (EF≥45%), 0=HFrEF (EF&lt;45%) - <code>creatinine_value</code>: Serum creatinine (mg/dL) - <code>egfr</code>: Estimated glomerular filtration rate (derived from 2021 CKD-EPI equation)</p>
<p><strong>Physical Performance:</strong> - <code>bl_sppb</code>, <code>fu_sppb</code>: Baseline and 12-week SPPB score (0-12, higher=better) - <code>bl_smw</code>, <code>fu_smw</code>: Baseline and 12-week six-minute walk distance (meters)</p>
<p><strong>Clinical Outcomes:</strong> - <code>rehosp</code>: Rehospitalization (0/1) - <code>death</code>: Death (0/1) - <code>event</code>: Rehospitalization or death (0/1)</p>
<p><strong>Intervention:</strong> - <code>intervention_1_control_0</code>: 1=rehabilitation intervention, 0=attention control</p>
</section>
<section id="ggplot2-theme-customization" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2-theme-customization">ggplot2 Theme Customization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">theme_gray</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">rgb</span>(.<span class="dv">9</span>, .<span class="dv">95</span>, <span class="dv">1</span>), <span class="at">colour =</span> <span class="fu">gray</span>(.<span class="dv">5</span>), <span class="at">linewidth =</span> .<span class="dv">2</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="fu">gray</span>(.<span class="dv">70</span>)),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>)),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-processing" class="level1">
<h1>Data Processing</h1>
<section id="read-olink-proteomics-data" class="level2">
<h2 class="anchored" data-anchor-id="read-olink-proteomics-data">Read Olink Proteomics Data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Baseline proteomics samples: 243 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Follow-up proteomics samples: 157 </code></pre>
</div>
</div>
</section>
<section id="read-clinical-data" class="level2">
<h2 class="anchored" data-anchor-id="read-clinical-data">Read Clinical Data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Total REHAB-HF participants: 349 </code></pre>
</div>
</div>
</section>
<section id="calculate-egfr" class="level2">
<h2 class="anchored" data-anchor-id="calculate-egfr">Calculate eGFR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021 CKD-EPI Creatinine Equation</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>kpa <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rhfds<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rhfds<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.241</span>, <span class="sc">-</span><span class="fl">0.302</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>const <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rhfds<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">1.012</span>, <span class="dv">1</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>rhfds<span class="sc">$</span>egfr <span class="ot">&lt;-</span> <span class="dv">142</span> <span class="sc">*</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">pmin</span>(<span class="fu">as.numeric</span>(rhfds<span class="sc">$</span>creatinine_value) <span class="sc">/</span> kpa, <span class="dv">1</span>) <span class="sc">^</span> alpha) <span class="sc">*</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">pmax</span>(<span class="fu">as.numeric</span>(rhfds<span class="sc">$</span>creatinine_value) <span class="sc">/</span> kpa, <span class="dv">1</span>) <span class="sc">^</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">*</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">0.9938</span> <span class="sc">^</span> rhfds<span class="sc">$</span>age) <span class="sc">*</span> const</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-biomarker-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-biomarker-data">Clean Biomarker Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove (D) indicators</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>rbiods <span class="ot">&lt;-</span> <span class="fu">apply</span>(rbiods, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">"(D)"</span>, <span class="st">""</span>, x, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove spaces</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, x, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create QNS indicator</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>qns_ind <span class="ot">&lt;-</span> <span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">grepl</span>(<span class="st">"QNS"</span>, x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(qns_ind) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">colnames</span>(qns_ind), <span class="st">"_qns_ind"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>rbiods <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(rbiods, qns_ind))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">"QNS"</span>, <span class="cn">NA</span>, x, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create censoring indicators</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>cens_ind <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(rbiods), <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>cens_ind[<span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">grepl</span>(<span class="st">"[&gt;&lt;]"</span>, x))] <span class="ot">&lt;-</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(<span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="fu">grep</span>(<span class="st">"[&gt;&lt;]"</span>, x)]))</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cens_ind) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">colnames</span>(rbiods)[<span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>], <span class="st">"_cens_ind"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>rbiods <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(rbiods, cens_ind))</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute censored values</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>rbiods<span class="sc">$</span>creatinine_mg_dl[rbiods<span class="sc">$</span>creatinine_mg_dl_cens_ind <span class="sc">!=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.15</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>rbiods<span class="sc">$</span>hs_crp_mg_l[rbiods<span class="sc">$</span>hs_crp_mg_l_cens_ind <span class="sc">!=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>rbiods<span class="sc">$</span>nt_pro_bnp[rbiods<span class="sc">$</span>nt_pro_bnp_cens_ind <span class="sc">!=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">35000</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>rbiods<span class="sc">$</span>troponin_t_ng_l[rbiods<span class="sc">$</span>troponin_t_ng_l_cens_ind <span class="sc">!=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(rbiods[, <span class="dv">12</span><span class="sc">:</span><span class="dv">21</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merge-data" class="level2">
<h2 class="anchored" data-anchor-id="merge-data">Merge Data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Baseline dataset:  243 subjects with 115 variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Follow-up dataset:  157 subjects with 115 variables</code></pre>
</div>
</div>
</section>
<section id="identify-key-proteins" class="level2">
<h2 class="anchored" data-anchor-id="identify-key-proteins">Identify Key Proteins</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>protlist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ALCAM"</span>, <span class="st">"Gal-4"</span>, <span class="st">"PECAM-1"</span>, <span class="st">"GP6"</span>, <span class="st">"ST2"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proteins selected for analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proteins selected for analysis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(protlist, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ALCAM, Gal-4, PECAM-1, GP6, ST2 </code></pre>
</div>
</div>
</section>
</section>
<section id="results-analysis" class="level1">
<h1>Results Analysis</h1>
<section id="table-1-baseline-patient-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="table-1-baseline-patient-characteristics">Table 1: Baseline Patient Characteristics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>varlist_table1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"intervention_1_control_0"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"race___4"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hf_cat"</span>, <span class="st">"egfr"</span>, <span class="st">"bl_sppb"</span>, <span class="st">"bl_smw"</span>), protlist</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_summary</span>(rprotblds[, varlist_table1],</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> intervention_1_control_0,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"continuous2"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">c</span>(</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{mean} ({sd})"</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{median} ({p25}, {p75})"</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{min}, {max}"</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} / {N} ({p}%)"</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">~</span> <span class="st">"Age"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    sex <span class="sc">~</span> <span class="st">"Sex (Female=1)"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    race___4 <span class="sc">~</span> <span class="st">"Race (White=1)"</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    hf_cat <span class="sc">~</span> <span class="st">"HF Category (HFpEF=1)"</span>,</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    egfr <span class="sc">~</span> <span class="st">"EGFR"</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    bl_sppb <span class="sc">~</span> <span class="st">"Baseline SPPB"</span>,</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    bl_smw <span class="sc">~</span> <span class="st">"Baseline 6MWD"</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing_text =</span> <span class="st">"(Missing)"</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>(<span class="fu">list</span>(</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"wilcox.test"</span>,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"fisher.test"</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_n</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">"**Variable**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Baseline Patient Characteristics**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_spanning_header</span>(<span class="fu">c</span>(<span class="st">"stat_1"</span>, <span class="st">"stat_2"</span>) <span class="sc">~</span> <span class="st">"**Control (0) vs. Intervention (1)**"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bliwyjysxj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bliwyjysxj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bliwyjysxj thead, #bliwyjysxj tbody, #bliwyjysxj tfoot, #bliwyjysxj tr, #bliwyjysxj td, #bliwyjysxj th {
  border-style: none;
}

#bliwyjysxj p {
  margin: 0;
  padding: 0;
}

#bliwyjysxj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bliwyjysxj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bliwyjysxj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bliwyjysxj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bliwyjysxj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bliwyjysxj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bliwyjysxj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bliwyjysxj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bliwyjysxj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bliwyjysxj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bliwyjysxj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bliwyjysxj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bliwyjysxj .gt_spanner_row {
  border-bottom-style: hidden;
}

#bliwyjysxj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bliwyjysxj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bliwyjysxj .gt_from_md > :first-child {
  margin-top: 0;
}

#bliwyjysxj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bliwyjysxj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bliwyjysxj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bliwyjysxj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bliwyjysxj .gt_row_group_first td {
  border-top-width: 2px;
}

#bliwyjysxj .gt_row_group_first th {
  border-top-width: 2px;
}

#bliwyjysxj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bliwyjysxj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bliwyjysxj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bliwyjysxj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bliwyjysxj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bliwyjysxj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bliwyjysxj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bliwyjysxj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bliwyjysxj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bliwyjysxj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bliwyjysxj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bliwyjysxj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bliwyjysxj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bliwyjysxj .gt_left {
  text-align: left;
}

#bliwyjysxj .gt_center {
  text-align: center;
}

#bliwyjysxj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bliwyjysxj .gt_font_normal {
  font-weight: normal;
}

#bliwyjysxj .gt_font_bold {
  font-weight: bold;
}

#bliwyjysxj .gt_font_italic {
  font-style: italic;
}

#bliwyjysxj .gt_super {
  font-size: 65%;
}

#bliwyjysxj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bliwyjysxj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bliwyjysxj .gt_indent_1 {
  text-indent: 5px;
}

#bliwyjysxj .gt_indent_2 {
  text-indent: 10px;
}

#bliwyjysxj .gt_indent_3 {
  text-indent: 15px;
}

#bliwyjysxj .gt_indent_4 {
  text-indent: 20px;
}

#bliwyjysxj .gt_indent_5 {
  text-indent: 25px;
}

#bliwyjysxj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bliwyjysxj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Baseline Patient Characteristics</strong></caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variable</strong></th>
<th rowspan="2" id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N</strong></th>
<th colspan="2" id="**Control (0) vs. Intervention (1)**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Control (0) vs.&nbsp;Intervention (1)</strong>
</div></th>
<th rowspan="2" id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>0</strong><br> N = 113<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>1</strong><br> N = 130<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Age</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">72 (8)</td>
<td class="gt_row gt_center" headers="stat_2">73 (8)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">72 (66, 77)</td>
<td class="gt_row gt_center" headers="stat_2">72 (65, 79)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">60, 90</td>
<td class="gt_row gt_center" headers="stat_2">60, 100</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Sex (Female=1)</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.12</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;0</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">48 / 113 (42%)</td>
<td class="gt_row gt_center" headers="stat_2">69 / 130 (53%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">65 / 113 (58%)</td>
<td class="gt_row gt_center" headers="stat_2">61 / 130 (47%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Race (White=1)</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;0</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">55 / 113 (49%)</td>
<td class="gt_row gt_center" headers="stat_2">55 / 130 (42%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">58 / 113 (51%)</td>
<td class="gt_row gt_center" headers="stat_2">75 / 130 (58%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">HF Category (HFpEF=1)</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;0</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">56 / 113 (50%)</td>
<td class="gt_row gt_center" headers="stat_2">59 / 130 (45%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">57 / 113 (50%)</td>
<td class="gt_row gt_center" headers="stat_2">71 / 130 (55%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">EGFR</td>
<td class="gt_row gt_center" headers="n">242</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">56 (23)</td>
<td class="gt_row gt_center" headers="stat_2">53 (22)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">57 (34, 70)</td>
<td class="gt_row gt_center" headers="stat_2">49 (36, 70)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">18, 101</td>
<td class="gt_row gt_center" headers="stat_2">17, 107</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;(Missing)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">0</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Baseline SPPB</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.15 (2.58)</td>
<td class="gt_row gt_center" headers="stat_2">6.07 (2.74)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.00 (4.00, 8.00)</td>
<td class="gt_row gt_center" headers="stat_2">6.00 (4.00, 8.00)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1.00, 12.00</td>
<td class="gt_row gt_center" headers="stat_2">1.00, 12.00</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Baseline 6MWD</td>
<td class="gt_row gt_center" headers="n">237</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">194 (109)</td>
<td class="gt_row gt_center" headers="stat_2">200 (108)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">175 (102, 260)</td>
<td class="gt_row gt_center" headers="stat_2">188 (100, 270)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">30, 489</td>
<td class="gt_row gt_center" headers="stat_2">12, 547</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;(Missing)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">5</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">ALCAM</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.68 (0.38)</td>
<td class="gt_row gt_center" headers="stat_2">6.68 (0.39)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.68 (6.44, 6.91)</td>
<td class="gt_row gt_center" headers="stat_2">6.66 (6.40, 6.89)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">5.16, 7.82</td>
<td class="gt_row gt_center" headers="stat_2">5.99, 8.28</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Gal-4</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">3.94 (0.67)</td>
<td class="gt_row gt_center" headers="stat_2">3.96 (0.69)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">3.93 (3.58, 4.36)</td>
<td class="gt_row gt_center" headers="stat_2">3.95 (3.54, 4.37)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">2.45, 6.13</td>
<td class="gt_row gt_center" headers="stat_2">2.38, 6.45</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PECAM-1</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">3.46 (0.41)</td>
<td class="gt_row gt_center" headers="stat_2">3.41 (0.34)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">3.45 (3.22, 3.71)</td>
<td class="gt_row gt_center" headers="stat_2">3.44 (3.19, 3.65)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">2.17, 4.75</td>
<td class="gt_row gt_center" headers="stat_2">2.36, 4.34</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">GP6</td>
<td class="gt_row gt_center" headers="n">242</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1.86 (0.54)</td>
<td class="gt_row gt_center" headers="stat_2">1.78 (0.58)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1.86 (1.50, 2.16)</td>
<td class="gt_row gt_center" headers="stat_2">1.73 (1.39, 2.17)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">0.75, 4.00</td>
<td class="gt_row gt_center" headers="stat_2">0.55, 3.55</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;(Missing)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">0</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">ST2</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.053</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.64 (0.88)</td>
<td class="gt_row gt_center" headers="stat_2">6.85 (0.89)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (Q1, Q3)</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">6.55 (5.95, 7.26)</td>
<td class="gt_row gt_center" headers="stat_2">6.77 (6.29, 7.39)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="n"><br>
</td>
<td class="gt_row gt_center" headers="stat_1">4.89, 9.44</td>
<td class="gt_row gt_center" headers="stat_2">4.76, 9.43</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n / N (%)</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test; Fisher’s exact test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="table-2-linear-regression-results" class="level2">
<h2 class="anchored" data-anchor-id="table-2-linear-regression-results">Table 2: Linear Regression Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tmpdf <span class="ot">&lt;-</span> rprotblds</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmpdf)[<span class="fu">which</span>(<span class="fu">colnames</span>(rprotblds) <span class="sc">%in%</span> protlist)] <span class="ot">&lt;-</span> <span class="fu">make.names</span>(protlist, <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>protlistclean <span class="ot">&lt;-</span> <span class="fu">make.names</span>(protlist, <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>regresults.sppb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> protlist,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unadjusted.Effect =</span> <span class="cn">NA</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unadjusted.Pval =</span> <span class="cn">NA</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adjusted.Effect =</span> <span class="cn">NA</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adjusted.Pval =</span> <span class="cn">NA</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interaction.Pval =</span> <span class="cn">NA</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>regresults<span class="fl">.6</span>mwd <span class="ot">&lt;-</span> regresults.sppb</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(protlist)) {</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SPPB ANALYSIS</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  mod.sppb.unadj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_sppb ~ bl_sppb + "</span>,</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">" + "</span>,</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"intervention_1_control_0"</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  mod.sppb.adj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_sppb ~ bl_sppb + "</span>,</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">"*intervention_1_control_0 + "</span>,</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age + sex + race___4 + hf_cat*intervention_1_control_0"</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Unadjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod.sppb.unadj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.unadj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.unadj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Unadjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod.sppb.unadj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Adjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod.sppb.adj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.adj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.adj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Adjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod.sppb.adj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Interaction.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod.sppb.adj)<span class="sc">$</span>coefficients[<span class="fu">paste0</span>(protlistclean[i], <span class="st">":intervention_1_control_01"</span>), <span class="dv">4</span>], <span class="dv">4</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6MWD ANALYSIS</span></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>  mod<span class="fl">.6</span>mwd.unadj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_smw ~ bl_smw + "</span>,</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">" + "</span>,</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">"intervention_1_control_0"</span></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>  mod<span class="fl">.6</span>mwd.adj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_smw ~ bl_smw + "</span>,</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">"*intervention_1_control_0 + "</span>,</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age + sex + race___4 + hf_cat*intervention_1_control_0"</span></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Unadjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod<span class="fl">.6</span>mwd.unadj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.unadj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.unadj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Unadjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.unadj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Adjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod<span class="fl">.6</span>mwd.adj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.adj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.adj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Adjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.adj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Interaction.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.adj)<span class="sc">$</span>coefficients[<span class="fu">paste0</span>(protlistclean[i], <span class="st">":intervention_1_control_01"</span>), <span class="dv">4</span>], <span class="dv">4</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sppb-results" class="level3">
<h3 class="anchored" data-anchor-id="sppb-results">SPPB Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(regresults.sppb, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Results: 12-Week Change in SPPB"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Linear Regression Results: 12-Week Change in SPPB</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 14%">
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Protein</th>
<th style="text-align: left;">Unadjusted.Effect</th>
<th style="text-align: right;">Unadjusted.Pval</th>
<th style="text-align: left;">Adjusted.Effect</th>
<th style="text-align: right;">Adjusted.Pval</th>
<th style="text-align: right;">Interaction.Pval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALCAM</td>
<td style="text-align: left;">-0.4932 (-1.4243, 0.438)</td>
<td style="text-align: right;">0.2976</td>
<td style="text-align: left;">-1.5927 (-2.9339, -0.2514)</td>
<td style="text-align: right;">0.0202</td>
<td style="text-align: right;">0.0253</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gal-4</td>
<td style="text-align: left;">0.0505 (-0.5907, 0.6917)</td>
<td style="text-align: right;">0.8768</td>
<td style="text-align: left;">-0.8812 (-1.8872, 0.1248)</td>
<td style="text-align: right;">0.0857</td>
<td style="text-align: right;">0.0436</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PECAM-1</td>
<td style="text-align: left;">-0.0712 (-0.6092, 0.4668)</td>
<td style="text-align: right;">0.7944</td>
<td style="text-align: left;">-0.2861 (-1.0569, 0.4846)</td>
<td style="text-align: right;">0.4651</td>
<td style="text-align: right;">0.3175</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP6</td>
<td style="text-align: left;">-0.6924 (-1.089, -0.2958)</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: left;">-0.561 (-1.1238, 0.0018)</td>
<td style="text-align: right;">0.0507</td>
<td style="text-align: right;">0.8223</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2</td>
<td style="text-align: left;">-0.7618 (-1.672, 0.1484)</td>
<td style="text-align: right;">0.1004</td>
<td style="text-align: left;">-1.1629 (-2.371, 0.0451)</td>
<td style="text-align: right;">0.0591</td>
<td style="text-align: right;">0.0930</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mwd-results" class="level3">
<h3 class="anchored" data-anchor-id="mwd-results">6MWD Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(regresults<span class="fl">.6</span>mwd,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Results: 12-Week Change in 6MWD"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Linear Regression Results: 12-Week Change in 6MWD</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Protein</th>
<th style="text-align: left;">Unadjusted.Effect</th>
<th style="text-align: right;">Unadjusted.Pval</th>
<th style="text-align: left;">Adjusted.Effect</th>
<th style="text-align: right;">Adjusted.Pval</th>
<th style="text-align: right;">Interaction.Pval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALCAM</td>
<td style="text-align: left;">-13.1899 (-51.6667, 25.287)</td>
<td style="text-align: right;">0.4996</td>
<td style="text-align: left;">-85.5014 (-150.8338, -20.1689)</td>
<td style="text-align: right;">0.0106</td>
<td style="text-align: right;">0.0131</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gal-4</td>
<td style="text-align: left;">14.3248 (-10.7234, 39.373)</td>
<td style="text-align: right;">0.2606</td>
<td style="text-align: left;">31.5552 (-12.7043, 75.8146)</td>
<td style="text-align: right;">0.1611</td>
<td style="text-align: right;">0.2296</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PECAM-1</td>
<td style="text-align: left;">-18.7947 (-39.3627, 1.7733)</td>
<td style="text-align: right;">0.0730</td>
<td style="text-align: left;">-41.7496 (-72.1123, -11.387)</td>
<td style="text-align: right;">0.0073</td>
<td style="text-align: right;">0.0395</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP6</td>
<td style="text-align: left;">-9.8635 (-26.4327, 6.7058)</td>
<td style="text-align: right;">0.2417</td>
<td style="text-align: left;">-12.636 (-37.0755, 11.8034)</td>
<td style="text-align: right;">0.3089</td>
<td style="text-align: right;">0.4415</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2</td>
<td style="text-align: left;">-11.2435 (-46.9298, 24.4429)</td>
<td style="text-align: right;">0.5349</td>
<td style="text-align: left;">-29.0777 (-77.9402, 19.7849)</td>
<td style="text-align: right;">0.2418</td>
<td style="text-align: right;">0.2211</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="figure-1-protein-correlations" class="level2">
<h2 class="anchored" data-anchor-id="figure-1-protein-correlations">Figure 1: Protein Correlations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>scmat <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="fu">which</span>(<span class="fu">colnames</span>(rprotblds) <span class="sc">%in%</span> protlist)],</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>), <span class="dv">2</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>scmat[<span class="fu">lower.tri</span>(scmat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>scmat_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(scmat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scmat_melt)) {</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(scmat_melt<span class="sc">$</span>Var1[i])</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(scmat_melt<span class="sc">$</span>Var2[i])</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  scmat_melt<span class="sc">$</span>pval[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    rprotblds[, <span class="fu">which</span>(<span class="fu">colnames</span>(rprotblds) <span class="sc">%in%</span> b1)],</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    rprotblds[, <span class="fu">which</span>(<span class="fu">colnames</span>(rprotblds) <span class="sc">%in%</span> b2)],</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>p.value</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties

Warning in cor.test.default(rprotblds[, which(colnames(rprotblds) %in% b1)], :
Cannot compute exact p-value with ties</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>scmat_melt<span class="sc">$</span>sig <span class="ot">&lt;-</span> scmat_melt<span class="sc">$</span>pval <span class="sc">&lt;</span> <span class="fl">0.01</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>scmat_melt<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  scmat_melt<span class="sc">$</span>sig <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> scmat_melt<span class="sc">$</span>value <span class="sc">!=</span> <span class="dv">1</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(scmat_melt<span class="sc">$</span>value, <span class="st">"*"</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  scmat_melt<span class="sc">$</span>value</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scmat_melt, <span class="fu">aes</span>(Var2, Var1, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(Var2, Var1, <span class="at">label =</span> text), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.7</span>),</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">barwidth =</span> <span class="dv">7</span>, <span class="at">barheight =</span> <span class="dv">1</span>,</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">"top"</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Baseline Protein Correlations (Spearman)"</span>)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/figure1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figures-2-3-protein-outcome-relationships" class="level2">
<h2 class="anchored" data-anchor-id="figures-2-3-protein-outcome-relationships">Figures 2 &amp; 3: Protein-Outcome Relationships</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rprotblds_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rprotblds[, <span class="fu">c</span>(<span class="st">"subject_id"</span>, <span class="st">"timepoint"</span>, <span class="st">"intervention_1_control_0"</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"bl_smw"</span>, <span class="st">"fu_smw"</span>, <span class="st">"bl_sppb"</span>, <span class="st">"fu_sppb"</span>, protlist)],</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> protlist,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">'Protein'</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">'ExpressionLevel'</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(protlist)

  # Now:
  data %&gt;% select(all_of(protlist))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rprotblds_long<span class="sc">$</span>sppb_chg <span class="ot">&lt;-</span> rprotblds_long<span class="sc">$</span>fu_sppb <span class="sc">-</span> rprotblds_long<span class="sc">$</span>bl_sppb</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>rprotblds_long<span class="sc">$</span>smw_chg <span class="ot">&lt;-</span> rprotblds_long<span class="sc">$</span>fu_smw <span class="sc">-</span> rprotblds_long<span class="sc">$</span>bl_smw</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rprotblds_long)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"Intervention"</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>rprotblds_long<span class="sc">$</span>Protein <span class="ot">&lt;-</span> <span class="fu">factor</span>(rprotblds_long<span class="sc">$</span>Protein, <span class="at">levels =</span> protlist)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>protlist<span class="fl">.6</span>mwd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ALCAM"</span>, <span class="st">"Gal-4"</span>, <span class="st">"PECAM-1"</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>protlist.sppb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GP6"</span>, <span class="st">"ST2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="figure-2-sppb-changes" class="level3">
<h3 class="anchored" data-anchor-id="figure-2-sppb-changes">Figure 2: SPPB Changes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rprotblds_long[rprotblds_long<span class="sc">$</span>Protein <span class="sc">%in%</span> protlist.sppb, ],</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ExpressionLevel, <span class="at">y =</span> sppb_chg, <span class="at">color =</span> Intervention)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">'Protein'</span>, <span class="at">scales =</span> <span class="st">'free'</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Protein expression units (NPX)"</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"12-week change in SPPB score"</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Rehabilitation</span><span class="sc">\n</span><span class="st">Intervention"</span>, <span class="st">"Attention</span><span class="sc">\n</span><span class="st">Control"</span>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>),</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/figure2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-3-6mwd-changes" class="level3">
<h3 class="anchored" data-anchor-id="figure-3-6mwd-changes">Figure 3: 6MWD Changes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rprotblds_long[rprotblds_long<span class="sc">$</span>Protein <span class="sc">%in%</span> protlist<span class="fl">.6</span>mwd, ],</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ExpressionLevel, <span class="at">y =</span> smw_chg, <span class="at">color =</span> Intervention)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">'Protein'</span>, <span class="at">scales =</span> <span class="st">'free'</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Protein expression units (NPX)"</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"12-week change in 6MWD (meters)"</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Rehabilitation</span><span class="sc">\n</span><span class="st">Intervention"</span>, <span class="st">"Attention</span><span class="sc">\n</span><span class="st">Control"</span>)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>),</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/figure3-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="protein-effect-measure-modifier-selection" class="level1">
<h1>Protein Effect Measure Modifier Selection</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename protein columns to remove special characters for tab_model compatibility</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>tmpdf <span class="ot">&lt;-</span> rprotblds</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmpdf)[<span class="fu">which</span>(<span class="fu">colnames</span>(rprotblds) <span class="sc">%in%</span> protlist)] <span class="ot">&lt;-</span> <span class="fu">make.names</span>(protlist, <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>protlistclean <span class="ot">&lt;-</span> <span class="fu">make.names</span>(protlist, <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize results dataframes</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>regresults.sppb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> protlist,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unadjusted.Effect =</span> <span class="cn">NA</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unadjusted.Pval =</span> <span class="cn">NA</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adjusted.Effect =</span> <span class="cn">NA</span>,</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adjusted.Pval =</span> <span class="cn">NA</span>,</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interaction.Pval =</span> <span class="cn">NA</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>regresults<span class="fl">.6</span>mwd <span class="ot">&lt;-</span> regresults.sppb</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression for each protein</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(protlist)) {</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- SPPB ANALYSIS ----</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  fname <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Results/RegressionAnalyses/SPPBvs"</span>, protlist[i], <span class="st">"_regressionanalysis.html"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  ttl <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Follow up SPPB ~ Baseline SPPB + "</span>, protlist[i], <span class="st">" + Intervention + More"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unadjusted model: protein + intervention (no interaction)</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  mod.sppb.unadj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_sppb ~ bl_sppb + "</span>,</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">" + "</span>,</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"intervention_1_control_0"</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjusted model: protein*intervention interaction + covariates</span></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  mod.sppb.adj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_sppb ~ bl_sppb + "</span>,</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">"*intervention_1_control_0 + "</span>,</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age + sex + race___4 + hf_cat*intervention_1_control_0"</span></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate HTML output</span></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tab_model</span>(</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod.sppb.unadj),</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod.sppb.adj),</span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ttl,</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> fname,</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits.p =</span> <span class="dv">4</span>,</span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.obs =</span> <span class="cn">TRUE</span></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract and store results</span></span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Unadjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod.sppb.unadj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.unadj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.unadj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb81-57"><a href="#cb81-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb81-58"><a href="#cb81-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-59"><a href="#cb81-59" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Unadjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod.sppb.unadj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb81-60"><a href="#cb81-60" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Adjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb81-61"><a href="#cb81-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod.sppb.adj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb81-62"><a href="#cb81-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb81-63"><a href="#cb81-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.adj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb81-64"><a href="#cb81-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb81-65"><a href="#cb81-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod.sppb.adj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb81-66"><a href="#cb81-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb81-67"><a href="#cb81-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-68"><a href="#cb81-68" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Adjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod.sppb.adj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb81-69"><a href="#cb81-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract interaction p-value</span></span>
<span id="cb81-70"><a href="#cb81-70" aria-hidden="true" tabindex="-1"></a>  regresults.sppb<span class="sc">$</span>Interaction.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb81-71"><a href="#cb81-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod.sppb.adj)<span class="sc">$</span>coefficients[<span class="fu">paste0</span>(protlistclean[i], <span class="st">":intervention_1_control_01"</span>), <span class="dv">4</span>], <span class="dv">4</span></span>
<span id="cb81-72"><a href="#cb81-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-73"><a href="#cb81-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- 6MWD ANALYSIS ----</span></span>
<span id="cb81-74"><a href="#cb81-74" aria-hidden="true" tabindex="-1"></a>  fname <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Results/RegressionAnalyses/6MWDvs"</span>, protlist[i], <span class="st">"_regressionanalysis.html"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb81-75"><a href="#cb81-75" aria-hidden="true" tabindex="-1"></a>  ttl <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Follow up 6MWD ~ Baseline 6MWD + "</span>, protlist[i], <span class="st">" + Intervention + More"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb81-76"><a href="#cb81-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unadjusted model</span></span>
<span id="cb81-77"><a href="#cb81-77" aria-hidden="true" tabindex="-1"></a>  mod<span class="fl">.6</span>mwd.unadj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb81-78"><a href="#cb81-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb81-79"><a href="#cb81-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb81-80"><a href="#cb81-80" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_smw ~ bl_smw + "</span>,</span>
<span id="cb81-81"><a href="#cb81-81" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">" + "</span>,</span>
<span id="cb81-82"><a href="#cb81-82" aria-hidden="true" tabindex="-1"></a>      <span class="st">"intervention_1_control_0"</span></span>
<span id="cb81-83"><a href="#cb81-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-84"><a href="#cb81-84" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-85"><a href="#cb81-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjusted model</span></span>
<span id="cb81-86"><a href="#cb81-86" aria-hidden="true" tabindex="-1"></a>  mod<span class="fl">.6</span>mwd.adj <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb81-87"><a href="#cb81-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmpdf,</span>
<span id="cb81-88"><a href="#cb81-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">paste0</span>(</span>
<span id="cb81-89"><a href="#cb81-89" aria-hidden="true" tabindex="-1"></a>      <span class="st">"fu_smw ~ bl_smw + "</span>,</span>
<span id="cb81-90"><a href="#cb81-90" aria-hidden="true" tabindex="-1"></a>      protlistclean[i], <span class="st">"*intervention_1_control_0 + "</span>,</span>
<span id="cb81-91"><a href="#cb81-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age + sex + race___4 + hf_cat*intervention_1_control_0"</span></span>
<span id="cb81-92"><a href="#cb81-92" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-93"><a href="#cb81-93" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-94"><a href="#cb81-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate HTML output</span></span>
<span id="cb81-95"><a href="#cb81-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tab_model</span>(</span>
<span id="cb81-96"><a href="#cb81-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.unadj),</span>
<span id="cb81-97"><a href="#cb81-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.adj),</span>
<span id="cb81-98"><a href="#cb81-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ttl,</span>
<span id="cb81-99"><a href="#cb81-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> fname,</span>
<span id="cb81-100"><a href="#cb81-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb81-101"><a href="#cb81-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits.p =</span> <span class="dv">4</span>,</span>
<span id="cb81-102"><a href="#cb81-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.obs =</span> <span class="cn">TRUE</span></span>
<span id="cb81-103"><a href="#cb81-103" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb81-104"><a href="#cb81-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract and store results</span></span>
<span id="cb81-105"><a href="#cb81-105" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Unadjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb81-106"><a href="#cb81-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod<span class="fl">.6</span>mwd.unadj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb81-107"><a href="#cb81-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb81-108"><a href="#cb81-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.unadj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb81-109"><a href="#cb81-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb81-110"><a href="#cb81-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.unadj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb81-111"><a href="#cb81-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb81-112"><a href="#cb81-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-113"><a href="#cb81-113" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Unadjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.unadj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb81-114"><a href="#cb81-114" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Adjusted.Effect[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb81-115"><a href="#cb81-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mod<span class="fl">.6</span>mwd.adj<span class="sc">$</span>coefficients[protlistclean[i]], <span class="dv">4</span>),</span>
<span id="cb81-116"><a href="#cb81-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">" ("</span>,</span>
<span id="cb81-117"><a href="#cb81-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.adj, protlistclean[i])[<span class="dv">1</span>], <span class="dv">4</span>),</span>
<span id="cb81-118"><a href="#cb81-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">", "</span>,</span>
<span id="cb81-119"><a href="#cb81-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">confint</span>(mod<span class="fl">.6</span>mwd.adj, protlistclean[i])[<span class="dv">2</span>], <span class="dv">4</span>),</span>
<span id="cb81-120"><a href="#cb81-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">")"</span></span>
<span id="cb81-121"><a href="#cb81-121" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-122"><a href="#cb81-122" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Adjusted.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.adj)<span class="sc">$</span>coefficients[protlistclean[i], <span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb81-123"><a href="#cb81-123" aria-hidden="true" tabindex="-1"></a>  regresults<span class="fl">.6</span>mwd<span class="sc">$</span>Interaction.Pval[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb81-124"><a href="#cb81-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(mod<span class="fl">.6</span>mwd.adj)<span class="sc">$</span>coefficients[<span class="fu">paste0</span>(protlistclean[i], <span class="st">":intervention_1_control_01"</span>), <span class="dv">4</span>], <span class="dv">4</span></span>
<span id="cb81-125"><a href="#cb81-125" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-126"><a href="#cb81-126" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sppb-results-1" class="level3">
<h3 class="anchored" data-anchor-id="sppb-results-1">SPPB Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(regresults.sppb, <span class="at">caption =</span> <span class="st">"SPPB Regression Results"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>SPPB Regression Results</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 14%">
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Protein</th>
<th style="text-align: left;">Unadjusted.Effect</th>
<th style="text-align: right;">Unadjusted.Pval</th>
<th style="text-align: left;">Adjusted.Effect</th>
<th style="text-align: right;">Adjusted.Pval</th>
<th style="text-align: right;">Interaction.Pval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALCAM</td>
<td style="text-align: left;">-0.4932 (-1.4243, 0.438)</td>
<td style="text-align: right;">0.2976</td>
<td style="text-align: left;">-1.5927 (-2.9339, -0.2514)</td>
<td style="text-align: right;">0.0202</td>
<td style="text-align: right;">0.0253</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gal-4</td>
<td style="text-align: left;">0.0505 (-0.5907, 0.6917)</td>
<td style="text-align: right;">0.8768</td>
<td style="text-align: left;">-0.8812 (-1.8872, 0.1248)</td>
<td style="text-align: right;">0.0857</td>
<td style="text-align: right;">0.0436</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PECAM-1</td>
<td style="text-align: left;">-0.0712 (-0.6092, 0.4668)</td>
<td style="text-align: right;">0.7944</td>
<td style="text-align: left;">-0.2861 (-1.0569, 0.4846)</td>
<td style="text-align: right;">0.4651</td>
<td style="text-align: right;">0.3175</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP6</td>
<td style="text-align: left;">-0.6924 (-1.089, -0.2958)</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: left;">-0.561 (-1.1238, 0.0018)</td>
<td style="text-align: right;">0.0507</td>
<td style="text-align: right;">0.8223</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2</td>
<td style="text-align: left;">-0.7618 (-1.672, 0.1484)</td>
<td style="text-align: right;">0.1004</td>
<td style="text-align: left;">-1.1629 (-2.371, 0.0451)</td>
<td style="text-align: right;">0.0591</td>
<td style="text-align: right;">0.0930</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mwd-results-1" class="level3">
<h3 class="anchored" data-anchor-id="mwd-results-1">6MWD Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(regresults<span class="fl">.6</span>mwd, <span class="at">caption =</span> <span class="st">"6MWD Regression Results"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6MWD Regression Results</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Protein</th>
<th style="text-align: left;">Unadjusted.Effect</th>
<th style="text-align: right;">Unadjusted.Pval</th>
<th style="text-align: left;">Adjusted.Effect</th>
<th style="text-align: right;">Adjusted.Pval</th>
<th style="text-align: right;">Interaction.Pval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALCAM</td>
<td style="text-align: left;">-13.1899 (-51.6667, 25.287)</td>
<td style="text-align: right;">0.4996</td>
<td style="text-align: left;">-85.5014 (-150.8338, -20.1689)</td>
<td style="text-align: right;">0.0106</td>
<td style="text-align: right;">0.0131</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gal-4</td>
<td style="text-align: left;">14.3248 (-10.7234, 39.373)</td>
<td style="text-align: right;">0.2606</td>
<td style="text-align: left;">31.5552 (-12.7043, 75.8146)</td>
<td style="text-align: right;">0.1611</td>
<td style="text-align: right;">0.2296</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PECAM-1</td>
<td style="text-align: left;">-18.7947 (-39.3627, 1.7733)</td>
<td style="text-align: right;">0.0730</td>
<td style="text-align: left;">-41.7496 (-72.1123, -11.387)</td>
<td style="text-align: right;">0.0073</td>
<td style="text-align: right;">0.0395</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP6</td>
<td style="text-align: left;">-9.8635 (-26.4327, 6.7058)</td>
<td style="text-align: right;">0.2417</td>
<td style="text-align: left;">-12.636 (-37.0755, 11.8034)</td>
<td style="text-align: right;">0.3089</td>
<td style="text-align: right;">0.4415</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ST2</td>
<td style="text-align: left;">-11.2435 (-46.9298, 24.4429)</td>
<td style="text-align: right;">0.5349</td>
<td style="text-align: left;">-29.0777 (-77.9402, 19.7849)</td>
<td style="text-align: right;">0.2418</td>
<td style="text-align: right;">0.2211</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== EFFECT MODIFICATION SCREENING (Individual Proteins) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== EFFECT MODIFICATION SCREENING (Individual Proteins) ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- SPPB ANALYSIS ----</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>intxn_df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">92</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(intxn_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"effect"</span>, <span class="st">"p-value"</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>) {</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  prot <span class="ot">&lt;-</span> <span class="fu">names</span>(rprotblds)[i]</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  formtmp <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"fu_sppb ~ bl_sppb + age + sex + race___4 + hf_cat + `"</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                   prot, <span class="st">"`*intervention_1_control_0"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  tmpmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data =</span> rprotblds, <span class="at">formula =</span> formtmp))</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  intxn_df[i <span class="sc">-</span> <span class="dv">2</span>, ] <span class="ot">&lt;-</span> tmpmod<span class="sc">$</span>coefficients[<span class="fu">nrow</span>(tmpmod<span class="sc">$</span>coefficients), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>intxn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> <span class="fu">names</span>(rprotblds)[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>],</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  intxn_df,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significance =</span> <span class="fu">ifelse</span>(intxn_df[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Significant"</span>, <span class="st">"Not Significant"</span>)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co"># FDR adjustment</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SPPB p-value distribution after FDR:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SPPB p-value distribution after FDR:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">p.adjust</span>(intxn_df<span class="sc">$</span>p.value, <span class="at">method =</span> <span class="st">'fdr'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4430  0.6299  0.8561  0.7804  0.9143  0.9926 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 6MWD ANALYSIS ----</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>intxn_df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">92</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(intxn_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"effect"</span>, <span class="st">"p-value"</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>) {</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  prot <span class="ot">&lt;-</span> <span class="fu">names</span>(rprotblds)[i]</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  formtmp <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"fu_smw ~ bl_smw + age + sex + race___4 + hf_cat + `"</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                   prot, <span class="st">"`*intervention_1_control_0"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  tmpmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data =</span> rprotblds, <span class="at">formula =</span> formtmp))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  intxn_df[i <span class="sc">-</span> <span class="dv">2</span>, ] <span class="ot">&lt;-</span> tmpmod<span class="sc">$</span>coefficients[<span class="fu">nrow</span>(tmpmod<span class="sc">$</span>coefficients), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>intxn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> <span class="fu">names</span>(rprotblds)[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>],</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  intxn_df,</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significance =</span> <span class="fu">ifelse</span>(intxn_df[, <span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Significant"</span>, <span class="st">"Not Significant"</span>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">6MWD p-value distribution after FDR:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
6MWD p-value distribution after FDR:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">p.adjust</span>(intxn_df<span class="sc">$</span>p.value, <span class="at">method =</span> <span class="st">'fdr'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2583  0.3393  0.6864  0.6255  0.8417  0.9675 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== GLINTERNET LASSO SCREENING ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== GLINTERNET LASSO SCREENING ===</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- SPPB ANALYSIS ----</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>sppb_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="fu">c</span>(<span class="st">"fu_sppb"</span>, <span class="st">"intervention_1_control_0"</span>, <span class="st">"bl_sppb"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"race___4"</span>, <span class="st">"hf_cat"</span>)],</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>]</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>sppb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(sppb_data)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">97</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>sppb_y <span class="ot">&lt;-</span> sppb_data<span class="sc">$</span>fu_sppb</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for glinternet (factors must be 0/1)</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>sppb_x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervention_1_control_0 =</span> <span class="fu">as.numeric</span>(sppb_data<span class="sc">$</span>intervention_1_control_0) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>bl_sppb,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>age,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">as.numeric</span>(sppb_data<span class="sc">$</span>sex) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">race___4 =</span> <span class="fu">as.numeric</span>(sppb_data<span class="sc">$</span>race___4) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">hf_cat =</span> <span class="fu">as.numeric</span>(sppb_data<span class="sc">$</span>hf_cat) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>  sppb_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>]</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify number of levels (1 = continuous, 2 = binary)</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>numLevels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">92</span>))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation to select lambda</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>fit.cv <span class="ot">&lt;-</span> <span class="fu">glinternet.cv</span>(sppb_x, sppb_y, <span class="at">numLevels =</span> numLevels, <span class="at">nFolds =</span> <span class="dv">10</span>, <span class="at">nLambda =</span> <span class="dv">10</span>)</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glinternet</span>(sppb_x, sppb_y, <span class="at">numLevels =</span> numLevels, <span class="at">lambda =</span> fit.cv<span class="sc">$</span>lambdaHat)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[[<span class="dv">2</span>]]</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SPPB - Proteins with treatment interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SPPB - Proteins with treatment interaction:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(sppb_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>])[coeffs<span class="sc">$</span>interactions<span class="sc">$</span>catcont[, <span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "GP6"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SPPB - Main effects:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SPPB - Main effects:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(sppb_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>])[coeffs<span class="sc">$</span>mainEffects<span class="sc">$</span>cont[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>)] <span class="sc">-</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "TNFSF13B"       "SHPS-1"         "ST2"            "PI3"           
 [5] "IGFBP-1"        "CTSD"           "IL2-RA"         "ALCAM"         
 [9] "PDGF subunit A" "TFF3"           "KLK6"           "SELP"          
[13] "CDH5"           "MCP-1"          "MPO"            "BLM hydrolase" 
[17] "CPA1"           "TLT-2"          "CHIT1"          "FABP4"         
[21] "CCL24"          "PRTN3"          "SPON1"          "CCL15"         
[25] "ICAM-2"         "CXCL16"         "PGLYRP1"        "CTSZ"          
[29] "Ep-CAM"         "SCGB3A2"        "IGFBP-7"        "GP6"           </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 6MWD ANALYSIS ----</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>smw_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="fu">c</span>(<span class="st">"fu_smw"</span>, <span class="st">"intervention_1_control_0"</span>, <span class="st">"bl_smw"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"race___4"</span>, <span class="st">"hf_cat"</span>)],</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>]</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>smw_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(smw_data)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">567</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>smw_y <span class="ot">&lt;-</span> smw_data<span class="sc">$</span>fu_smw</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>smw_x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervention_1_control_0 =</span> <span class="fu">as.numeric</span>(smw_data<span class="sc">$</span>intervention_1_control_0) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>bl_smw,</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>age,</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">as.numeric</span>(smw_data<span class="sc">$</span>sex) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">race___4 =</span> <span class="fu">as.numeric</span>(smw_data<span class="sc">$</span>race___4) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">hf_cat =</span> <span class="fu">as.numeric</span>(smw_data<span class="sc">$</span>hf_cat) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  smw_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>]</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>numLevels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">92</span>))</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>fit.cv <span class="ot">&lt;-</span> <span class="fu">glinternet.cv</span>(smw_x, smw_y, <span class="at">numLevels =</span> numLevels, <span class="at">nFolds =</span> <span class="dv">10</span>, <span class="at">nLambda =</span> <span class="dv">10</span>)</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glinternet</span>(smw_x, smw_y, <span class="at">numLevels =</span> numLevels, <span class="at">lambda =</span> fit.cv<span class="sc">$</span>lambdaHat)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[[<span class="dv">2</span>]]</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">6MWD - Proteins with treatment interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
6MWD - Proteins with treatment interaction:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(smw_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>])[coeffs<span class="sc">$</span>interactions<span class="sc">$</span>catcont[, <span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ALCAM" "Gal-4"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">6MWD - Main effects:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
6MWD - Main effects:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(smw_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>])[coeffs<span class="sc">$</span>mainEffects<span class="sc">$</span>cont[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>)] <span class="sc">-</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CXCL16"         "TNFSF13B"       "PRTN3"          "ITGB2"         
 [5] "SELE"           "LDL receptor"   "MMP-9"          "IL2-RA"        
 [9] "CHIT1"          "PDGF subunit A" "IL-17RA"        "PSP-D"         
[13] "uPA"            "SELP"           "IL-1RT1"        "CPA1"          
[17] "Notch 3"        "ICAM-2"         "CNTN1"          "MEPE"          
[21] "CDH5"           "SCGB3A2"        "TLT-2"          "CTSD"          
[25] "PAI"            "ST2"            "GDF-15"         "CCL16"         
[29] "DLK-1"          "CPB1"           "SPON1"          "IL-6RA"        
[33] "MMP-2"          "RETN"           "IGFBP-1"        "PCSK9"         
[37] "GP6"            "PI3"            "EGFR"           "t-PA"          
[41] "ALCAM"          "Gal-4"         </code></pre>
</div>
</div>
</section>
<section id="bart-screening" class="level3">
<h3 class="anchored" data-anchor-id="bart-screening">BART screening</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== BART INTERACTION IMPORTANCE ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== BART INTERACTION IMPORTANCE ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">45</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">java.parameters =</span> <span class="st">"-Xmx4000m"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_bart_machine_num_cores</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine now using 1 cores.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- SPPB BART MODEL ----</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>sppb_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="fu">c</span>(<span class="st">"fu_sppb"</span>, <span class="st">"intervention_1_control_0"</span>, <span class="st">"bl_sppb"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"race___4"</span>, <span class="st">"hf_cat"</span>)],</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>]</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>sppb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(sppb_data)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>sppb_y <span class="ot">&lt;-</span> sppb_data<span class="sc">$</span>fu_sppb</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>sppb_x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>intervention_1_control_0,</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>bl_sppb,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>age,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>sex,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>race___4,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  sppb_data<span class="sc">$</span>hf_cat,</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  sppb_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>]</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>bart_machine_sppb <span class="ot">&lt;-</span> <span class="fu">bartMachine</span>(</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  sppb_x, sppb_y,</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_trees =</span> <span class="dv">100</span>,</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_burn_in =</span> <span class="dv">2000</span>,</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_iterations_after_burn_in =</span> <span class="dv">2000</span>,</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_missing_data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">mem_cache_for_speed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">34</span></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine initializing with 100 trees...
bartMachine vars checked...
bartMachine java init...
bartMachine factors created...
bartMachine before preprocess...
bartMachine after preprocess... 102 total features...
bartMachine sigsq estimated...
bartMachine training data finalized...
Now building bartMachine for regression...Covariate importance prior ON. Missing data feature ON. 
evaluating in sample data...done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bart_machine_sppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine v1.3.4.1 for regression

Missing data feature ON
training data size: n = 202 and p = 102 
built in 6.9 secs on 1 core, 100 trees, 2000 burn-in and 2000 post. samples

sigsq est for y beforehand: 2.703 
avg sigsq estimate after burn-in: 4.76879 

in-sample statistics:
 L1 = 283.32 
 L2 = 650.11 
 rmse = 1.79 
 Pseudo-Rsq = 0.707
p-val for shapiro-wilk test of normality of residuals: 0 
p-val for zero-mean noise: 0.98309 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_convergence_diagnostics</span>(bart_machine_sppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/bart-sppb-model-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction importance with 100 replicates</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>intxninvest <span class="ot">&lt;-</span> <span class="fu">interaction_investigator</span>(bart_machine_sppb,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_var_plot =</span> <span class="dv">25</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">bottom_margin =</span> <span class="dv">20</span>,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_replicates_for_avg =</span> reps,</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_trees_bottleneck =</span> <span class="dv">20</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>........................................
........................................
....................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract interaction importance</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>bartintxn_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(intxninvest<span class="sc">$</span>interaction_counts[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">96</span>, ], <span class="dv">1</span>, sum) <span class="sc">/</span> reps</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>bartintxn_sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(intxninvest<span class="sc">$</span>interaction_counts[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">96</span>, ], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), sum), <span class="dv">1</span>, sd)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>bartintxn_moe <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> bartintxn_sds <span class="sc">/</span> <span class="fu">sqrt</span>(reps)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> <span class="fu">rownames</span>(intxninvest<span class="sc">$</span>interaction_counts_avg)[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>],</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Importance =</span> bartintxn_means,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">MOE =</span> bartintxn_moe</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> bartintxn_df[<span class="fu">order</span>(bartintxn_df<span class="sc">$</span>Importance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot top 20</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> bartintxn_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ]</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>bars <span class="ot">&lt;-</span> <span class="fu">barplot</span>(bartintxn_df<span class="sc">$</span>Importance,</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">names.arg =</span> bartintxn_df<span class="sc">$</span>Protein,</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">"Importance"</span>,</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"gray"</span>,</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(bartintxn_df<span class="sc">$</span>Importance <span class="sc">+</span> bartintxn_df<span class="sc">$</span>MOE))</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>conf_upper <span class="ot">&lt;-</span> bartintxn_df<span class="sc">$</span>Importance <span class="sc">+</span> bartintxn_df<span class="sc">$</span>MOE</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>conf_lower <span class="ot">&lt;-</span> bartintxn_df<span class="sc">$</span>Importance <span class="sc">-</span> bartintxn_df<span class="sc">$</span>MOE</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bars, bartintxn_df<span class="sc">$</span>Importance, bars, conf_upper,</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.59</span>, <span class="fl">0.39</span>, <span class="fl">0.39</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bars, bartintxn_df<span class="sc">$</span>Importance, bars, conf_lower,</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.59</span>, <span class="fl">0.39</span>, <span class="fl">0.39</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/bart-sppb-model-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sppb-bart-results" class="level3">
<h3 class="anchored" data-anchor-id="sppb-bart-results">SPPB BART Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(bartintxn_df, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">"SPPB - Top 20 Proteins by BART Interaction Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>SPPB - Top 20 Proteins by BART Interaction Importance</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Protein</th>
<th style="text-align: right;">Importance</th>
<th style="text-align: right;">MOE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">72</td>
<td style="text-align: left;">ST2</td>
<td style="text-align: right;">55.40</td>
<td style="text-align: right;">18.9825</td>
</tr>
<tr class="even">
<td style="text-align: left;">31</td>
<td style="text-align: left;">TR</td>
<td style="text-align: right;">29.02</td>
<td style="text-align: right;">6.0627</td>
</tr>
<tr class="odd">
<td style="text-align: left;">92</td>
<td style="text-align: left;">CCL16</td>
<td style="text-align: right;">28.87</td>
<td style="text-align: right;">9.5433</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: left;">BLM.hydrolase</td>
<td style="text-align: right;">28.49</td>
<td style="text-align: right;">12.6450</td>
</tr>
<tr class="odd">
<td style="text-align: left;">34</td>
<td style="text-align: left;">SELE</td>
<td style="text-align: right;">27.92</td>
<td style="text-align: right;">6.5400</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">MCP.1</td>
<td style="text-align: right;">24.44</td>
<td style="text-align: right;">5.4683</td>
</tr>
<tr class="odd">
<td style="text-align: left;">66</td>
<td style="text-align: left;">SHPS.1</td>
<td style="text-align: right;">23.38</td>
<td style="text-align: right;">6.0284</td>
</tr>
<tr class="even">
<td style="text-align: left;">29</td>
<td style="text-align: left;">PAI</td>
<td style="text-align: right;">22.47</td>
<td style="text-align: right;">6.6316</td>
</tr>
<tr class="odd">
<td style="text-align: left;">85</td>
<td style="text-align: left;">KLK6</td>
<td style="text-align: right;">22.39</td>
<td style="text-align: right;">5.7695</td>
</tr>
<tr class="even">
<td style="text-align: left;">47</td>
<td style="text-align: left;">PI3</td>
<td style="text-align: right;">22.32</td>
<td style="text-align: right;">5.9428</td>
</tr>
<tr class="odd">
<td style="text-align: left;">64</td>
<td style="text-align: left;">Gal.4</td>
<td style="text-align: right;">21.76</td>
<td style="text-align: right;">9.8406</td>
</tr>
<tr class="even">
<td style="text-align: left;">55</td>
<td style="text-align: left;">TNFSF13B</td>
<td style="text-align: right;">20.68</td>
<td style="text-align: right;">3.6748</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71</td>
<td style="text-align: left;">CHI3L1</td>
<td style="text-align: right;">20.62</td>
<td style="text-align: right;">4.8965</td>
</tr>
<tr class="even">
<td style="text-align: left;">35</td>
<td style="text-align: left;">AZU1</td>
<td style="text-align: right;">20.25</td>
<td style="text-align: right;">6.7330</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: left;">PLC</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">8.1763</td>
</tr>
<tr class="even">
<td style="text-align: left;">45</td>
<td style="text-align: left;">GP6</td>
<td style="text-align: right;">20.18</td>
<td style="text-align: right;">5.2201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">89</td>
<td style="text-align: left;">vWF</td>
<td style="text-align: right;">19.71</td>
<td style="text-align: right;">7.1979</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">LDL.receptor</td>
<td style="text-align: right;">19.55</td>
<td style="text-align: right;">4.9018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">44</td>
<td style="text-align: left;">TR.AP</td>
<td style="text-align: right;">19.40</td>
<td style="text-align: right;">5.5839</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">IL.17RA</td>
<td style="text-align: right;">19.33</td>
<td style="text-align: right;">6.5282</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 6MWD BART MODEL ----</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">231</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">java.parameters =</span> <span class="st">"-Xmx4000m"</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set_bart_machine_num_cores</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine now using 1 cores.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>smw_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="fu">c</span>(<span class="st">"fu_smw"</span>, <span class="st">"intervention_1_control_0"</span>, <span class="st">"bl_smw"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"race___4"</span>, <span class="st">"hf_cat"</span>)],</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>]</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>smw_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(smw_data)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>smw_y <span class="ot">&lt;-</span> smw_data<span class="sc">$</span>fu_smw</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>smw_x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>intervention_1_control_0,</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>bl_smw,</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>age,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>sex,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>race___4,</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>  smw_data<span class="sc">$</span>hf_cat,</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  smw_data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">99</span>]</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>bart_machine_smw <span class="ot">&lt;-</span> <span class="fu">bartMachine</span>(</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>  smw_x, smw_y,</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_trees =</span> <span class="dv">100</span>,</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_burn_in =</span> <span class="dv">2000</span>,</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_iterations_after_burn_in =</span> <span class="dv">2000</span>,</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_missing_data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">mem_cache_for_speed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">231</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine initializing with 100 trees...
bartMachine vars checked...
bartMachine java init...
bartMachine factors created...
bartMachine before preprocess...
bartMachine after preprocess... 102 total features...
bartMachine sigsq estimated...
bartMachine training data finalized...
Now building bartMachine for regression...Covariate importance prior ON. Missing data feature ON. 
evaluating in sample data...done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bart_machine_smw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bartMachine v1.3.4.1 for regression

Missing data feature ON
training data size: n = 172 and p = 102 
built in 5.8 secs on 1 core, 100 trees, 2000 burn-in and 2000 post. samples

sigsq est for y beforehand: 3101.303 
avg sigsq estimate after burn-in: 1712.49861 

in-sample statistics:
 L1 = 2410.51 
 L2 = 61764.6 
 rmse = 18.95 
 Pseudo-Rsq = 0.9788
p-val for shapiro-wilk test of normality of residuals: 5e-05 
p-val for zero-mean noise: 0.95756 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_convergence_diagnostics</span>(bart_machine_smw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/bart-6mwd-model-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>intxninvest <span class="ot">&lt;-</span> <span class="fu">interaction_investigator</span>(bart_machine_smw,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_var_plot =</span> <span class="dv">25</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">bottom_margin =</span> <span class="dv">20</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_replicates_for_avg =</span> reps,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">num_trees_bottleneck =</span> <span class="dv">20</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>........................................
........................................
....................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>bartintxn_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(intxninvest<span class="sc">$</span>interaction_counts[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">96</span>, ], <span class="dv">1</span>, sum) <span class="sc">/</span> reps</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>bartintxn_sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(intxninvest<span class="sc">$</span>interaction_counts[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">96</span>, ], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), sum), <span class="dv">1</span>, sd)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>bartintxn_moe <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> bartintxn_sds <span class="sc">/</span> <span class="fu">sqrt</span>(reps)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> <span class="fu">rownames</span>(intxninvest<span class="sc">$</span>interaction_counts_avg)[<span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>],</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Importance =</span> bartintxn_means,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">MOE =</span> bartintxn_moe</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> bartintxn_df[<span class="fu">order</span>(bartintxn_df<span class="sc">$</span>Importance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>bartintxn_df <span class="ot">&lt;-</span> bartintxn_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ]</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>bars <span class="ot">&lt;-</span> <span class="fu">barplot</span>(bartintxn_df<span class="sc">$</span>Importance,</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">names.arg =</span> bartintxn_df<span class="sc">$</span>Protein,</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">"Importance"</span>,</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"gray"</span>,</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(bartintxn_df<span class="sc">$</span>Importance <span class="sc">+</span> bartintxn_df<span class="sc">$</span>MOE))</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>conf_upper <span class="ot">&lt;-</span> bartintxn_df<span class="sc">$</span>Importance <span class="sc">+</span> bartintxn_df<span class="sc">$</span>MOE</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>conf_lower <span class="ot">&lt;-</span> bartintxn_df<span class="sc">$</span>Importance <span class="sc">-</span> bartintxn_df<span class="sc">$</span>MOE</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bars, bartintxn_df<span class="sc">$</span>Importance, bars, conf_upper,</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.59</span>, <span class="fl">0.39</span>, <span class="fl">0.39</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bars, bartintxn_df<span class="sc">$</span>Importance, bars, conf_lower,</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.59</span>, <span class="fl">0.39</span>, <span class="fl">0.39</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/bart-6mwd-model-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mwd-bart-results" class="level3">
<h3 class="anchored" data-anchor-id="mwd-bart-results">6MWD BART Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(bartintxn_df, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">"6MWD - Top 20 Proteins by BART Interaction Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")

Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6MWD - Top 20 Proteins by BART Interaction Importance</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Protein</th>
<th style="text-align: right;">Importance</th>
<th style="text-align: right;">MOE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">64</td>
<td style="text-align: left;">Gal.4</td>
<td style="text-align: right;">29.30</td>
<td style="text-align: right;">14.4358</td>
</tr>
<tr class="even">
<td style="text-align: left;">90</td>
<td style="text-align: left;">PECAM.1</td>
<td style="text-align: right;">29.08</td>
<td style="text-align: right;">14.1748</td>
</tr>
<tr class="odd">
<td style="text-align: left;">84</td>
<td style="text-align: left;">ICAM.2</td>
<td style="text-align: right;">25.55</td>
<td style="text-align: right;">17.2332</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">MCP.1</td>
<td style="text-align: right;">22.89</td>
<td style="text-align: right;">11.8211</td>
</tr>
<tr class="odd">
<td style="text-align: left;">73</td>
<td style="text-align: left;">t.PA</td>
<td style="text-align: right;">21.34</td>
<td style="text-align: right;">11.6262</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">Gal.3</td>
<td style="text-align: right;">18.59</td>
<td style="text-align: right;">5.7800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">58</td>
<td style="text-align: left;">U.PAR</td>
<td style="text-align: right;">15.74</td>
<td style="text-align: right;">9.5772</td>
</tr>
<tr class="even">
<td style="text-align: left;">86</td>
<td style="text-align: left;">PDGF.subunit.A</td>
<td style="text-align: right;">15.53</td>
<td style="text-align: right;">7.9885</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: left;">ALCAM</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">4.3384</td>
</tr>
<tr class="even">
<td style="text-align: left;">81</td>
<td style="text-align: left;">CTSZ</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">12.3715</td>
</tr>
<tr class="odd">
<td style="text-align: left;">71</td>
<td style="text-align: left;">CHI3L1</td>
<td style="text-align: right;">15.20</td>
<td style="text-align: right;">7.3647</td>
</tr>
<tr class="even">
<td style="text-align: left;">35</td>
<td style="text-align: left;">AZU1</td>
<td style="text-align: right;">14.87</td>
<td style="text-align: right;">11.3615</td>
</tr>
<tr class="odd">
<td style="text-align: left;">53</td>
<td style="text-align: left;">FAS</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">6.5898</td>
</tr>
<tr class="even">
<td style="text-align: left;">63</td>
<td style="text-align: left;">JAM.A</td>
<td style="text-align: right;">14.75</td>
<td style="text-align: right;">12.2808</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48</td>
<td style="text-align: left;">Ep.CAM</td>
<td style="text-align: right;">14.63</td>
<td style="text-align: right;">7.5672</td>
</tr>
<tr class="even">
<td style="text-align: left;">34</td>
<td style="text-align: left;">SELE</td>
<td style="text-align: right;">14.08</td>
<td style="text-align: right;">4.9351</td>
</tr>
<tr class="odd">
<td style="text-align: left;">65</td>
<td style="text-align: left;">IL.1RT2</td>
<td style="text-align: right;">13.76</td>
<td style="text-align: right;">5.0635</td>
</tr>
<tr class="even">
<td style="text-align: left;">39</td>
<td style="text-align: left;">CXCL16</td>
<td style="text-align: right;">13.39</td>
<td style="text-align: right;">3.8431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">76</td>
<td style="text-align: left;">IGFBP.7</td>
<td style="text-align: right;">13.04</td>
<td style="text-align: right;">5.1379</td>
</tr>
<tr class="even">
<td style="text-align: left;">47</td>
<td style="text-align: left;">PI3</td>
<td style="text-align: right;">11.79</td>
<td style="text-align: right;">3.5050</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>```</p>
</section>
</section>
<section id="propensity-score-matching-matching-trees" class="level1">
<h1>Propensity Score Matching &amp; Matching Trees</h1>
<section id="propensity-score-matching-setup" class="level2">
<h2 class="anchored" data-anchor-id="propensity-score-matching-setup">Propensity Score Matching Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>ps.df <span class="ot">&lt;-</span> rprotblds</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>ps.df<span class="sc">$</span>trt <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ps.df<span class="sc">$</span>intervention_1_control_0) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only subjects with complete data on key proteins and outcomes</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>ps.df <span class="ot">&lt;-</span> ps.df[<span class="fu">complete.cases</span>(ps.df[, <span class="fu">c</span>(<span class="st">"ALCAM"</span>, <span class="st">"Gal-4"</span>, <span class="st">"PECAM-1"</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"GP6"</span>, <span class="st">"ST2"</span>,</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">'bl_smw'</span>, <span class="st">'fu_smw'</span>, <span class="st">'bl_sppb'</span>, <span class="st">'fu_sppb'</span>)]), ]</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit propensity score model using logistic regression</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>ppty <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>  trt <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> race___4 <span class="sc">+</span> hf_cat,</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ps.df</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate propensity scores</span></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>prop.score <span class="ot">&lt;-</span> <span class="fu">predict.glm</span>(ppty, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">na.action =</span> na.exclude)</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>ps.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(ps.df, prop.score))</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matching distance matrix based on propensity scores</span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>ppty.distance <span class="ot">&lt;-</span> <span class="fu">match_on</span>(ppty)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Propensity Score Matching Summary</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Propensity Score Matching Summary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total subjects with complete data:"</span>, <span class="fu">nrow</span>(ps.df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total subjects with complete data: 181 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment:"</span>, <span class="fu">sum</span>(ps.df<span class="sc">$</span>trt <span class="sc">==</span> <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment: 99 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Control:"</span>, <span class="fu">sum</span>(ps.df<span class="sc">$</span>trt <span class="sc">==</span> <span class="dv">0</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Control: 82 </code></pre>
</div>
</div>
</section>
<section id="helper-functions-for-matching-tree-analysis" class="level2">
<h2 class="anchored" data-anchor-id="helper-functions-for-matching-tree-analysis">Helper Functions for Matching Tree Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get parent node in tree structure</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>parent <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x[<span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">Recall</span>(<span class="cf">if</span> (x <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>L) x <span class="sc">/</span> <span class="dv">2</span> <span class="cf">else</span> (x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>), x)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to prune tree based on treatment effect overlap</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>jesse.tree.select <span class="ot">&lt;-</span> <span class="cf">function</span>(input, set1.caliper.tree) {</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  fit.overlap <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  ptree1 <span class="ot">&lt;-</span> input</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (fit.overlap <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(ptree1<span class="sc">$</span>frame)[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span>) <span class="cf">break</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>    rownames <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(ptree1<span class="sc">$</span>frame))</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>    size <span class="ot">&lt;-</span> <span class="fu">dim</span>(ptree1<span class="sc">$</span>frame)[<span class="dv">1</span>]</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>    rownamesmax <span class="ot">&lt;-</span> rownames[<span class="fu">which.max</span>(rownames)]</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>    rownamessecond <span class="ot">&lt;-</span> rownames[<span class="fu">which</span>(rownames <span class="sc">==</span> <span class="fu">sort</span>(<span class="fu">unique</span>(rownames), <span class="at">partial =</span> size <span class="sc">-</span> <span class="dv">1</span>)[size <span class="sc">-</span> <span class="dv">1</span>])]</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>    subset1 <span class="ot">&lt;-</span> set1.caliper.tree[ptree1<span class="sc">$</span>where <span class="sc">==</span> <span class="fu">which</span>(rownames <span class="sc">==</span> rownamesmax), ]</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>    subset2 <span class="ot">&lt;-</span> set1.caliper.tree[ptree1<span class="sc">$</span>where <span class="sc">==</span> <span class="fu">which</span>(rownames <span class="sc">==</span> rownamessecond), ]</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>    dummy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="fu">dim</span>(subset1)[<span class="dv">1</span>]), <span class="fu">rep</span>(<span class="st">"2"</span>, <span class="fu">dim</span>(subset2)[<span class="dv">1</span>]))</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>    subsetf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rbind</span>(subset1, subset2), dummy)</span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>    subsetf<span class="sc">$</span>dummy <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(subsetf<span class="sc">$</span>dummy)</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>    subsetf<span class="sc">$</span>trt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(subsetf<span class="sc">$</span>trt)</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>    ls.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> dummy <span class="sc">*</span> trt, <span class="at">data =</span> subsetf)</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>    ls.list <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(ls.lm, <span class="fu">list</span>(pairwise <span class="sc">~</span> dummy <span class="sc">|</span> trt, pairwise <span class="sc">~</span> trt <span class="sc">|</span> dummy))</span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>    out1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">summary</span>(ls.list[[<span class="dv">4</span>]]))</span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a>    q.value <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a>    CI1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(out1[<span class="dv">1</span>, <span class="dv">3</span>]) <span class="sc">-</span> q.value <span class="sc">*</span> <span class="fu">as.numeric</span>(out1[<span class="dv">1</span>, <span class="dv">4</span>]),</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(out1[<span class="dv">1</span>, <span class="dv">3</span>]) <span class="sc">+</span> q.value <span class="sc">*</span> <span class="fu">as.numeric</span>(out1[<span class="dv">1</span>, <span class="dv">4</span>])</span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>    CI2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(out1[<span class="dv">2</span>, <span class="dv">3</span>]) <span class="sc">-</span> q.value <span class="sc">*</span> <span class="fu">as.numeric</span>(out1[<span class="dv">2</span>, <span class="dv">4</span>]),</span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(out1[<span class="dv">2</span>, <span class="dv">3</span>]) <span class="sc">+</span> q.value <span class="sc">*</span> <span class="fu">as.numeric</span>(out1[<span class="dv">2</span>, <span class="dv">4</span>])</span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a>    fit.overlap <span class="ot">&lt;-</span> <span class="fu">max</span>(CI1[<span class="dv">1</span>], CI2[<span class="dv">1</span>]) <span class="sc">&lt;</span> <span class="fu">min</span>(CI1[<span class="dv">2</span>], CI2[<span class="dv">2</span>])</span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a>    fit.overlap[<span class="fu">is.na</span>(fit.overlap)] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fit.overlap <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="cf">break</span></span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a>    ptree1 <span class="ot">&lt;-</span> <span class="fu">snip.rpart</span>(ptree1, <span class="at">toss =</span> <span class="fu">tail</span>(<span class="fu">head</span>(<span class="fu">parent</span>(rownamesmax), <span class="sc">-</span><span class="dv">1</span>), <span class="at">n =</span> <span class="dv">1</span>))</span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-52"><a href="#cb150-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-53"><a href="#cb150-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(ptree1<span class="sc">$</span>frame)[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb150-54"><a href="#cb150-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ptree1)</span>
<span id="cb150-55"><a href="#cb150-55" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb150-56"><a href="#cb150-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(input)</span>
<span id="cb150-57"><a href="#cb150-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-58"><a href="#cb150-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sppb-matching-tree-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sppb-matching-tree-analysis">SPPB Matching Tree Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate treatment and control groups</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>set.trt <span class="ot">&lt;-</span> ps.df[ps.df[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>set.cont <span class="ot">&lt;-</span> ps.df[ps.df[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1:1 matching with caliper on protein values</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>match.set <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>calp.sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Caliper width: 1 SD of protein values</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(set.trt)[<span class="dv">1</span>]) {</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>  pair.set1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if control subject is within caliper on both GP6 and ST2</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  var.select1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abs</span>(set.cont<span class="sc">$</span>GP6 <span class="sc">-</span> set.trt<span class="sc">$</span>GP6[i]) <span class="sc">&lt;</span> calp.sd <span class="sc">*</span> <span class="fu">sd</span>(set.trt<span class="sc">$</span>GP6),</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>  var.select2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abs</span>(set.cont<span class="sc">$</span>ST2 <span class="sc">-</span> set.trt<span class="sc">$</span>ST2[i]) <span class="sc">&lt;</span> calp.sd <span class="sc">*</span> <span class="fu">sd</span>(set.trt<span class="sc">$</span>ST2),</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>  var.selectf <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(var.select1 <span class="sc">+</span> var.select2 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>  id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var.selectf))</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>  lenset.cont2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(id, set.cont, var.selectf))</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>  lenset.cont3 <span class="ot">&lt;-</span> lenset.cont2[lenset.cont2[, <span class="st">"var.selectf"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Match to nearest propensity score if within caliper</span></span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(lenset.cont3)[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>    cont.index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(lenset.cont3<span class="sc">$</span>prop.score <span class="sc">-</span> set.trt<span class="sc">$</span>prop.score[i]))</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>    pair.set <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>      set.trt[i, ],</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>      lenset.cont3[cont.index, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fu">dim</span>(lenset.cont3)[<span class="dv">2</span>])]</span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    pairin <span class="ot">&lt;-</span> <span class="fu">rep</span>(i, <span class="dv">2</span>)</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>    pair.set1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pair.set, pairin)</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>    set.cont <span class="ot">&lt;-</span> set.cont[<span class="sc">!</span>set.cont<span class="sc">$</span>prop.score <span class="sc">==</span> lenset.cont3<span class="sc">$</span>prop.score[cont.index], ]</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>    pair.set1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>    set.cont <span class="ot">&lt;-</span> set.cont</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>  match.set <span class="ot">&lt;-</span> <span class="fu">rbind</span>(match.set, pair.set1)</span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate treatment effect</span></span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>treat.set <span class="ot">&lt;-</span> match.set[match.set[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>control.set <span class="ot">&lt;-</span> match.set[match.set[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>outcome.diff <span class="ot">&lt;-</span> (treat.set<span class="sc">$</span>fu_sppb <span class="sc">-</span> treat.set<span class="sc">$</span>bl_sppb) <span class="sc">-</span></span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>                (control.set<span class="sc">$</span>fu_sppb <span class="sc">-</span> control.set<span class="sc">$</span>bl_sppb)</span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>set.total <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(</span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(treat.set, outcome.diff),</span>
<span id="cb151-54"><a href="#cb151-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(control.set, outcome.diff)</span>
<span id="cb151-55"><a href="#cb151-55" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb151-56"><a href="#cb151-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-57"><a href="#cb151-57" aria-hidden="true" tabindex="-1"></a>matchedset.sppb <span class="ot">&lt;-</span> set.total</span>
<span id="cb151-58"><a href="#cb151-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-59"><a href="#cb151-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SPPB Matching Summary</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SPPB Matching Summary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"====================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>====================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Matched pairs:"</span>, <span class="fu">nrow</span>(treat.set), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matched pairs: 81 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total matched subjects:"</span>, <span class="fu">nrow</span>(set.total), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total matched subjects: 162 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build matching tree on proteins GP6 and ST2</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>tree.rpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  outcome.diff <span class="sc">~</span> GP6 <span class="sc">+</span> ST2,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"anova"</span>,</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> set.total,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minbucket =</span> <span class="dv">15</span>, <span class="at">maxdepth =</span> <span class="dv">2</span>)</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outcome variable and prune tree</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>set.total<span class="sc">$</span>outcome <span class="ot">&lt;-</span> set.total<span class="sc">$</span>fu_sppb <span class="sc">-</span> set.total<span class="sc">$</span>bl_sppb</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>tree.all <span class="ot">&lt;-</span> <span class="fu">jesse.tree.select</span>(tree.rpart, set.total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree.all, <span class="at">box.palette =</span> <span class="st">'Reds'</span>, <span class="at">extra =</span> <span class="dv">1</span>, </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Matching Tree for SPPB Outcome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/figure4a-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>set.total<span class="sc">$</span>sppb_node <span class="ot">&lt;-</span> <span class="fu">rpart.predict.leaves</span>(tree.all, set.total, <span class="at">type =</span> <span class="st">"where"</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>modscore.sppb <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> set.total, <span class="at">formula =</span> outcome.diff <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(sppb_node))</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SPPB Matching Tree - Treatment Effects by Node</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SPPB Matching Tree - Treatment Effects by Node</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==============================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==============================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(modscore.sppb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           2.5 %    97.5 %
as.factor(sppb_node)3 -1.8991465 0.2420037
as.factor(sppb_node)4  0.2071578 2.7928422
as.factor(sppb_node)5  1.4633097 2.7114475</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(modscore.sppb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = outcome.diff ~ 0 + as.factor(sppb_node), data = set.total)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.0874 -2.1504 -0.0874  1.9126  8.9126 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
as.factor(sppb_node)3  -0.8286     0.5421  -1.529   0.1284    
as.factor(sppb_node)4   1.5000     0.6546   2.291   0.0232 *  
as.factor(sppb_node)5   2.0874     0.3160   6.606 5.64e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.207 on 159 degrees of freedom
Multiple R-squared:  0.2437,    Adjusted R-squared:  0.2294 
F-statistic: 17.08 on 3 and 159 DF,  p-value: 1.158e-09</code></pre>
</div>
</div>
</section>
<section id="mwd-matching-tree-analysis" class="level2">
<h2 class="anchored" data-anchor-id="mwd-matching-tree-analysis">6MWD Matching Tree Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>set.trt <span class="ot">&lt;-</span> ps.df[ps.df[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>set.cont <span class="ot">&lt;-</span> ps.df[ps.df[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>match.set <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>calp.sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(set.trt)[<span class="dv">1</span>]) {</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  pair.set1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if control subject is within caliper on all three proteins</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>  var.select1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(set.cont<span class="sc">$</span>ALCAM <span class="sc">-</span> set.trt<span class="sc">$</span>ALCAM[i]) <span class="sc">&lt;</span> calp.sd <span class="sc">*</span> <span class="fu">sd</span>(set.trt<span class="sc">$</span>ALCAM), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  var.select2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(set.cont<span class="sc">$</span><span class="st">`</span><span class="at">Gal-4</span><span class="st">`</span> <span class="sc">-</span> set.trt<span class="sc">$</span><span class="st">`</span><span class="at">Gal-4</span><span class="st">`</span>[i]) <span class="sc">&lt;</span> calp.sd <span class="sc">*</span> <span class="fu">sd</span>(set.trt<span class="sc">$</span><span class="st">`</span><span class="at">Gal-4</span><span class="st">`</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>  var.select3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(set.cont<span class="sc">$</span><span class="st">`</span><span class="at">PECAM-1</span><span class="st">`</span> <span class="sc">-</span> set.trt<span class="sc">$</span><span class="st">`</span><span class="at">PECAM-1</span><span class="st">`</span>[i]) <span class="sc">&lt;</span> calp.sd <span class="sc">*</span> <span class="fu">sd</span>(set.trt<span class="sc">$</span><span class="st">`</span><span class="at">PECAM-1</span><span class="st">`</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>  var.selectf <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(var.select1 <span class="sc">+</span> var.select2 <span class="sc">+</span> var.select3 <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>  id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var.selectf))</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>  lenset.cont2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(id, set.cont, var.selectf))</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>  lenset.cont3 <span class="ot">&lt;-</span> lenset.cont2[lenset.cont2[, <span class="st">"var.selectf"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(lenset.cont3)[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>    cont.index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(lenset.cont3<span class="sc">$</span>prop.score <span class="sc">-</span> set.trt<span class="sc">$</span>prop.score[i]))</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>    pair.set <span class="ot">&lt;-</span> <span class="fu">rbind</span>(set.trt[i, ], lenset.cont3[cont.index, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fu">dim</span>(lenset.cont3)[<span class="dv">2</span>])])</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>    pairin <span class="ot">&lt;-</span> <span class="fu">rep</span>(i, <span class="dv">2</span>)</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>    pair.set1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pair.set, pairin)</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>    set.cont <span class="ot">&lt;-</span> set.cont[<span class="sc">!</span>set.cont<span class="sc">$</span>prop.score <span class="sc">==</span> lenset.cont3<span class="sc">$</span>prop.score[cont.index], ]</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>    pair.set1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>    set.cont <span class="ot">&lt;-</span> set.cont</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a>  match.set <span class="ot">&lt;-</span> <span class="fu">rbind</span>(match.set, pair.set1)</span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate treatment effect</span></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a>treat.set <span class="ot">&lt;-</span> match.set[match.set[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>control.set <span class="ot">&lt;-</span> match.set[match.set[, <span class="st">"trt"</span>] <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>outcome.diff <span class="ot">&lt;-</span> (treat.set<span class="sc">$</span>fu_smw <span class="sc">-</span> treat.set<span class="sc">$</span>bl_smw) <span class="sc">-</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a>                (control.set<span class="sc">$</span>fu_smw <span class="sc">-</span> control.set<span class="sc">$</span>bl_smw)</span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a>set.total <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(</span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(treat.set, outcome.diff),</span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(control.set, outcome.diff)</span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a>matchedset<span class="fl">.6</span>mwd <span class="ot">&lt;-</span> set.total</span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"6MWD Matching Summary</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6MWD Matching Summary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"====================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>====================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Matched pairs:"</span>, <span class="fu">nrow</span>(treat.set), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matched pairs: 71 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total matched subjects:"</span>, <span class="fu">nrow</span>(set.total), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total matched subjects: 142 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build matching tree</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>tree.rpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  outcome.diff <span class="sc">~</span> ALCAM <span class="sc">+</span> <span class="st">`</span><span class="at">Gal-4</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">PECAM-1</span><span class="st">`</span>,</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"anova"</span>,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> set.total,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minbucket =</span> <span class="dv">30</span>, <span class="at">maxdepth =</span> <span class="dv">1</span>)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>set.total<span class="sc">$</span>outcome <span class="ot">&lt;-</span> set.total<span class="sc">$</span>fu_smw <span class="sc">-</span> set.total<span class="sc">$</span>bl_smw</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>tree.all <span class="ot">&lt;-</span> <span class="fu">jesse.tree.select</span>(tree.rpart, set.total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree.all, <span class="at">box.palette =</span> <span class="st">'Reds'</span>, <span class="at">extra =</span> <span class="dv">1</span>,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Matching Tree for 6MWD Outcome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/figure4b-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>set.total<span class="sc">$</span>smw_node <span class="ot">&lt;-</span> <span class="fu">rpart.predict.leaves</span>(tree.all, set.total, <span class="at">type =</span> <span class="st">"where"</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>modscore.smw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> set.total, <span class="at">formula =</span> outcome.diff <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(smw_node))</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"6MWD Matching Tree - Treatment Effects by Node</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6MWD Matching Tree - Treatment Effects by Node</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==============================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==============================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(modscore.smw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         2.5 %    97.5 %
as.factor(smw_node)2 -16.52650  35.55242
as.factor(smw_node)3  56.36864 113.05136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(modscore.smw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = outcome.diff ~ 0 + as.factor(smw_node), data = set.total)

Residuals:
    Min      1Q  Median      3Q     Max 
-438.43  -55.15   -4.37   57.88  439.20 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
as.factor(smw_node)2    9.513     13.171   0.722    0.471    
as.factor(smw_node)3   84.710     14.335   5.909 2.49e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 115.6 on 140 degrees of freedom
Multiple R-squared:  0.202, Adjusted R-squared:  0.1906 
F-statistic: 17.72 on 2 and 140 DF,  p-value: 1.38e-07</code></pre>
</div>
</div>
</section>
<section id="cross-validation-performance-comparison" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-performance-comparison">Cross-Validation Performance Comparison</h2>
<section id="sppb-matching-tree-cv" class="level3">
<h3 class="anchored" data-anchor-id="sppb-matching-tree-cv">SPPB Matching Tree CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">67</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(treat.set)), <span class="at">breaks =</span> nfolds, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> folds[<span class="fu">sample</span>(<span class="fu">nrow</span>(treat.set))]</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>maxdepth <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>minbucket <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>)</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>bst <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>bst.stg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>cvres.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">maxdepth =</span> <span class="cn">NA</span>, <span class="at">minbucket =</span> <span class="cn">NA</span>, <span class="at">testrmse.dt =</span> <span class="cn">NA</span>, <span class="at">testrmse.rf =</span> <span class="cn">NA</span>)</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> maxdepth) {</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> minbucket) {</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> idx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>    tree<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>    tree.leaves <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>    tree.mod.train <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>    tree.test.rmse <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>    rf.mod.train <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>    rf.test.rmse <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>      ids <span class="ot">&lt;-</span> treat.set<span class="sc">$</span>subject_id[folds <span class="sc">!=</span> i]</span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>      pairs.train <span class="ot">&lt;-</span> set.total<span class="sc">$</span>pairin[set.total<span class="sc">$</span>subject_id <span class="sc">%in%</span> ids]</span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>      ids <span class="ot">&lt;-</span> treat.set<span class="sc">$</span>subject_id[folds <span class="sc">==</span> i]</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>      pairs.test <span class="ot">&lt;-</span> set.total<span class="sc">$</span>pairin[set.total<span class="sc">$</span>subject_id <span class="sc">%in%</span> ids]</span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> <span class="fu">rpart</span>(</span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a>        outcome.diff <span class="sc">~</span> GP6 <span class="sc">+</span> ST2,</span>
<span id="cb189-34"><a href="#cb189-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"anova"</span>,</span>
<span id="cb189-35"><a href="#cb189-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> set.total[set.total<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, ],</span>
<span id="cb189-36"><a href="#cb189-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">maxdepth =</span> j, <span class="at">minbucket =</span> k)</span>
<span id="cb189-37"><a href="#cb189-37" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb189-38"><a href="#cb189-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-39"><a href="#cb189-39" aria-hidden="true" tabindex="-1"></a>      tree<span class="fl">.2</span>[[i]] <span class="ot">&lt;-</span> <span class="fu">jesse.tree.select</span>(tmp, set.total)</span>
<span id="cb189-40"><a href="#cb189-40" aria-hidden="true" tabindex="-1"></a>      tree.leaves[[i]] <span class="ot">&lt;-</span> <span class="fu">rpart.predict.leaves</span>(tree<span class="fl">.2</span>[[i]], set.total, <span class="at">type =</span> <span class="st">"where"</span>)</span>
<span id="cb189-41"><a href="#cb189-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-42"><a href="#cb189-42" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(set.total, tree.leaves[[i]])</span>
<span id="cb189-43"><a href="#cb189-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(df)[<span class="fu">ncol</span>(df)] <span class="ot">&lt;-</span> <span class="st">"tree_leaves_temp"</span></span>
<span id="cb189-44"><a href="#cb189-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-45"><a href="#cb189-45" aria-hidden="true" tabindex="-1"></a>      tree.mod.train[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb189-46"><a href="#cb189-46" aria-hidden="true" tabindex="-1"></a>        outcome.diff <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(tree_leaves_temp),</span>
<span id="cb189-47"><a href="#cb189-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, ]</span>
<span id="cb189-48"><a href="#cb189-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb189-49"><a href="#cb189-49" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-50"><a href="#cb189-50" aria-hidden="true" tabindex="-1"></a>      tree.test.rmse[[i]] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((</span>
<span id="cb189-51"><a href="#cb189-51" aria-hidden="true" tabindex="-1"></a>        df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, <span class="st">'outcome.diff'</span>] <span class="sc">-</span></span>
<span id="cb189-52"><a href="#cb189-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(tree.mod.train[[i]], df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, ])</span>
<span id="cb189-53"><a href="#cb189-53" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb189-54"><a href="#cb189-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-55"><a href="#cb189-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit random forest</span></span>
<span id="cb189-56"><a href="#cb189-56" aria-hidden="true" tabindex="-1"></a>      rf.df.train <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, <span class="fu">c</span>(<span class="st">"outcome.diff"</span>, <span class="st">"GP6"</span>, <span class="st">"ST2"</span>)]</span>
<span id="cb189-57"><a href="#cb189-57" aria-hidden="true" tabindex="-1"></a>      rf.df.test <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, <span class="fu">c</span>(<span class="st">"outcome.diff"</span>, <span class="st">"GP6"</span>, <span class="st">"ST2"</span>)]</span>
<span id="cb189-58"><a href="#cb189-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-59"><a href="#cb189-59" aria-hidden="true" tabindex="-1"></a>      rf.mod.train[[i]] <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(outcome.diff <span class="sc">~</span> GP6 <span class="sc">+</span> ST2,</span>
<span id="cb189-60"><a href="#cb189-60" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">data =</span> rf.df.train, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb189-61"><a href="#cb189-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb189-62"><a href="#cb189-62" aria-hidden="true" tabindex="-1"></a>      rf.test.rmse[[i]] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((</span>
<span id="cb189-63"><a href="#cb189-63" aria-hidden="true" tabindex="-1"></a>        rf.df.test<span class="sc">$</span>outcome.diff <span class="sc">-</span></span>
<span id="cb189-64"><a href="#cb189-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(rf.mod.train[[i]], rf.df.test)</span>
<span id="cb189-65"><a href="#cb189-65" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb189-66"><a href="#cb189-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb189-67"><a href="#cb189-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-68"><a href="#cb189-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse)) <span class="sc">&lt;</span> bst) {</span>
<span id="cb189-69"><a href="#cb189-69" aria-hidden="true" tabindex="-1"></a>      bst <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse))</span>
<span id="cb189-70"><a href="#cb189-70" aria-hidden="true" tabindex="-1"></a>      bst.stg[<span class="dv">1</span>] <span class="ot">&lt;-</span> j</span>
<span id="cb189-71"><a href="#cb189-71" aria-hidden="true" tabindex="-1"></a>      bst.stg[<span class="dv">2</span>] <span class="ot">&lt;-</span> k</span>
<span id="cb189-72"><a href="#cb189-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb189-73"><a href="#cb189-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-74"><a href="#cb189-74" aria-hidden="true" tabindex="-1"></a>    cvres.df[idx, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(j, k, <span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse)), <span class="fu">mean</span>(<span class="fu">unlist</span>(rf.test.rmse)))</span>
<span id="cb189-75"><a href="#cb189-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb189-76"><a href="#cb189-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb189-77"><a href="#cb189-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-78"><a href="#cb189-78" aria-hidden="true" tabindex="-1"></a>cvres.df<span class="sc">$</span>maxdepth <span class="ot">&lt;-</span> <span class="fu">factor</span>(cvres.df<span class="sc">$</span>maxdepth, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb189-79"><a href="#cb189-79" aria-hidden="true" tabindex="-1"></a>cvres.df<span class="sc">$</span>minbucket <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(cvres.df<span class="sc">$</span>minbucket)</span>
<span id="cb189-80"><a href="#cb189-80" aria-hidden="true" tabindex="-1"></a>rf.mean.sppb <span class="ot">&lt;-</span> <span class="fu">mean</span>(cvres.df<span class="sc">$</span>testrmse.rf, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cvres.df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> minbucket, <span class="at">color =</span> maxdepth, <span class="at">fill =</span> maxdepth)) <span class="sc">+</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> testrmse.dt), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> testrmse.dt, <span class="at">shape =</span> maxdepth), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> rf.mean.sppb, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> rf.mean.sppb <span class="sc">+</span> <span class="fl">0.08</span>, </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Random Forest:"</span>, <span class="fu">round</span>(rf.mean.sppb, <span class="dv">3</span>)), </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Average Test RMSE"</span>) <span class="sc">+</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Minimum Bucket Size"</span>) <span class="sc">+</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cross-Validation Performance: SPPB Outcome"</span>,</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Decision Trees vs. Random Forest"</span>) <span class="sc">+</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Max Depth"</span>, </span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)) <span class="sc">+</span></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Max Depth"</span>,</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)) <span class="sc">+</span></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/cvplot-sppb-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mwd-matching-tree-cv" class="level3">
<h3 class="anchored" data-anchor-id="mwd-matching-tree-cv">6MWD Matching Tree CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">324</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>nfolds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(treat.set)), <span class="at">breaks =</span> nfolds, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> folds[<span class="fu">sample</span>(<span class="fu">nrow</span>(treat.set))]</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>maxdepth <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>minbucket <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>bst <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>bst.stg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>cvres.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">maxdepth =</span> <span class="cn">NA</span>, <span class="at">minbucket =</span> <span class="cn">NA</span>, <span class="at">testrmse.dt =</span> <span class="cn">NA</span>, <span class="at">testrmse.rf =</span> <span class="cn">NA</span>)</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> maxdepth) {</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> minbucket) {</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> idx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>    tree<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    tree.leaves <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>    tree.mod.train <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>    tree.test.rmse <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>    rf.mod.train <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>    rf.test.rmse <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfolds) {</span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>      ids <span class="ot">&lt;-</span> treat.set<span class="sc">$</span>subject_id[folds <span class="sc">!=</span> i]</span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>      pairs.train <span class="ot">&lt;-</span> set.total<span class="sc">$</span>pairin[set.total<span class="sc">$</span>subject_id <span class="sc">%in%</span> ids]</span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>      ids <span class="ot">&lt;-</span> treat.set<span class="sc">$</span>subject_id[folds <span class="sc">==</span> i]</span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>      pairs.test <span class="ot">&lt;-</span> set.total<span class="sc">$</span>pairin[set.total<span class="sc">$</span>subject_id <span class="sc">%in%</span> ids]</span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> <span class="fu">rpart</span>(</span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>        outcome.diff <span class="sc">~</span> ALCAM <span class="sc">+</span> <span class="st">`</span><span class="at">Gal-4</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">PECAM-1</span><span class="st">`</span>,</span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"anova"</span>,</span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> set.total[set.total<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, ],</span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">maxdepth =</span> j, <span class="at">minbucket =</span> k)</span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a>      tree<span class="fl">.2</span>[[i]] <span class="ot">&lt;-</span> <span class="fu">jesse.tree.select</span>(tmp, set.total)</span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a>      tree.leaves[[i]] <span class="ot">&lt;-</span> <span class="fu">rpart.predict.leaves</span>(tree<span class="fl">.2</span>[[i]], set.total, <span class="at">type =</span> <span class="st">"where"</span>)</span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-42"><a href="#cb191-42" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(set.total, tree.leaves[[i]])</span>
<span id="cb191-43"><a href="#cb191-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(df)[<span class="fu">ncol</span>(df)] <span class="ot">&lt;-</span> <span class="st">"tree_leaves_temp"</span></span>
<span id="cb191-44"><a href="#cb191-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-45"><a href="#cb191-45" aria-hidden="true" tabindex="-1"></a>      tree.mod.train[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb191-46"><a href="#cb191-46" aria-hidden="true" tabindex="-1"></a>        outcome.diff <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(tree_leaves_temp),</span>
<span id="cb191-47"><a href="#cb191-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, ]</span>
<span id="cb191-48"><a href="#cb191-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb191-49"><a href="#cb191-49" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-50"><a href="#cb191-50" aria-hidden="true" tabindex="-1"></a>      tree.test.rmse[[i]] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((</span>
<span id="cb191-51"><a href="#cb191-51" aria-hidden="true" tabindex="-1"></a>        df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, <span class="st">'outcome.diff'</span>] <span class="sc">-</span></span>
<span id="cb191-52"><a href="#cb191-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(tree.mod.train[[i]], df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, ])</span>
<span id="cb191-53"><a href="#cb191-53" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb191-54"><a href="#cb191-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-55"><a href="#cb191-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit random forest</span></span>
<span id="cb191-56"><a href="#cb191-56" aria-hidden="true" tabindex="-1"></a>      rf.df.train <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.train, <span class="fu">c</span>(<span class="st">"outcome.diff"</span>, <span class="st">"ALCAM"</span>, <span class="st">"Gal-4"</span>, <span class="st">"PECAM-1"</span>)]</span>
<span id="cb191-57"><a href="#cb191-57" aria-hidden="true" tabindex="-1"></a>      rf.df.test <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pairin <span class="sc">%in%</span> pairs.test, <span class="fu">c</span>(<span class="st">"outcome.diff"</span>, <span class="st">"ALCAM"</span>, <span class="st">"Gal-4"</span>, <span class="st">"PECAM-1"</span>)]</span>
<span id="cb191-58"><a href="#cb191-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-59"><a href="#cb191-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(rf.df.train) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(rf.df.train))</span>
<span id="cb191-60"><a href="#cb191-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(rf.df.test) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(rf.df.test))</span>
<span id="cb191-61"><a href="#cb191-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-62"><a href="#cb191-62" aria-hidden="true" tabindex="-1"></a>      rf.mod.train[[i]] <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(outcome.diff <span class="sc">~</span> ALCAM <span class="sc">+</span> Gal<span class="fl">.4</span> <span class="sc">+</span> PECAM<span class="fl">.1</span>,</span>
<span id="cb191-63"><a href="#cb191-63" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">data =</span> rf.df.train, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb191-64"><a href="#cb191-64" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb191-65"><a href="#cb191-65" aria-hidden="true" tabindex="-1"></a>      rf.test.rmse[[i]] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((</span>
<span id="cb191-66"><a href="#cb191-66" aria-hidden="true" tabindex="-1"></a>        rf.df.test<span class="sc">$</span>outcome.diff <span class="sc">-</span></span>
<span id="cb191-67"><a href="#cb191-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(rf.mod.train[[i]], rf.df.test)</span>
<span id="cb191-68"><a href="#cb191-68" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb191-69"><a href="#cb191-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb191-70"><a href="#cb191-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-71"><a href="#cb191-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse)) <span class="sc">&lt;</span> bst) {</span>
<span id="cb191-72"><a href="#cb191-72" aria-hidden="true" tabindex="-1"></a>      bst <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse))</span>
<span id="cb191-73"><a href="#cb191-73" aria-hidden="true" tabindex="-1"></a>      bst.stg[<span class="dv">1</span>] <span class="ot">&lt;-</span> j</span>
<span id="cb191-74"><a href="#cb191-74" aria-hidden="true" tabindex="-1"></a>      bst.stg[<span class="dv">2</span>] <span class="ot">&lt;-</span> k</span>
<span id="cb191-75"><a href="#cb191-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb191-76"><a href="#cb191-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-77"><a href="#cb191-77" aria-hidden="true" tabindex="-1"></a>    cvres.df[idx, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(j, k, <span class="fu">mean</span>(<span class="fu">unlist</span>(tree.test.rmse)), <span class="fu">mean</span>(<span class="fu">unlist</span>(rf.test.rmse)))</span>
<span id="cb191-78"><a href="#cb191-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb191-79"><a href="#cb191-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb191-80"><a href="#cb191-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-81"><a href="#cb191-81" aria-hidden="true" tabindex="-1"></a>cvres.df<span class="sc">$</span>maxdepth <span class="ot">&lt;-</span> <span class="fu">factor</span>(cvres.df<span class="sc">$</span>maxdepth, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb191-82"><a href="#cb191-82" aria-hidden="true" tabindex="-1"></a>cvres.df<span class="sc">$</span>minbucket <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(cvres.df<span class="sc">$</span>minbucket)</span>
<span id="cb191-83"><a href="#cb191-83" aria-hidden="true" tabindex="-1"></a>rf.mean<span class="fl">.6</span>mwd <span class="ot">&lt;-</span> <span class="fu">mean</span>(cvres.df<span class="sc">$</span>testrmse.rf, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cvres.df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> minbucket, <span class="at">color =</span> maxdepth, <span class="at">fill =</span> maxdepth)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> testrmse.dt), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> testrmse.dt, <span class="at">shape =</span> maxdepth), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> rf.mean<span class="fl">.6</span>mwd, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> rf.mean<span class="fl">.6</span>mwd <span class="sc">+</span> <span class="dv">2</span>, </span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Random Forest:"</span>, <span class="fu">round</span>(rf.mean<span class="fl">.6</span>mwd, <span class="dv">3</span>)), </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Average Test RMSE"</span>) <span class="sc">+</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Minimum Bucket Size"</span>) <span class="sc">+</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cross-Validation Performance: 6MWD Outcome"</span>,</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Decision Trees vs. Random Forest"</span>) <span class="sc">+</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Max Depth"</span>, </span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)) <span class="sc">+</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Max Depth"</span>,</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)) <span class="sc">+</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/cvplot-6mwd-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="network-analysis-wgcna" class="level1">
<h1>Network Analysis (WGCNA)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>naset <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">apply</span>(rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>rprotblds.std <span class="ot">&lt;-</span> <span class="fu">apply</span>(rprotblds[<span class="sc">-</span>naset, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>powers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>), <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">22</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>))</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>sft <span class="ot">&lt;-</span> <span class="fu">pickSoftThreshold</span>(<span class="fu">na.omit</span>(rprotblds[, <span class="dv">3</span><span class="sc">:</span><span class="dv">94</span>]), <span class="at">powerVector =</span> powers, <span class="at">verbose =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Power SFT.R.sq    slope truncated.R.sq  mean.k. median.k. max.k.
1      1   0.0001  0.00672        0.31400 20.80000  2.09e+01 37.100
2      2   0.7360 -0.76300        0.68100  7.65000  6.53e+00 20.600
3      3   0.8990 -0.93700        0.87200  3.59000  2.44e+00 13.300
4      4   0.9300 -1.04000        0.91200  1.96000  1.06e+00  9.290
5      5   0.8420 -1.11000        0.80700  1.19000  5.38e-01  6.900
6      6   0.0811 -1.53000       -0.08630  0.77200  2.62e-01  5.340
7      7   0.2200 -2.41000        0.05950  0.53100  1.34e-01  4.260
8      8   0.2200 -2.24000        0.07920  0.38200  7.06e-02  3.460
9      9   0.2080 -2.85000       -0.00276  0.28500  3.65e-02  2.870
10    10   0.2570 -3.01000        0.14200  0.21800  1.92e-02  2.410
11    11   0.2330 -3.20000        0.03110  0.17100  1.07e-02  2.040
12    12   0.2460 -3.24000        0.05210  0.13600  6.18e-03  1.750
13    13   0.2750 -3.33000        0.12300  0.11000  3.54e-03  1.500
14    14   0.2570 -3.49000        0.04900  0.09050  2.08e-03  1.310
15    15   0.2670 -3.50000        0.06370  0.07510  1.25e-03  1.140
16    16   0.2750 -3.52000        0.07630  0.06290  7.53e-04  0.997
17    17   0.3020 -3.57000        0.13000  0.05310  4.44e-04  0.877
18    18   0.3100 -3.50000        0.14400  0.04520  2.63e-04  0.774
19    19   0.2680 -3.27000        0.05890  0.03870  1.57e-04  0.685
20    20   0.2760 -3.23000        0.06970  0.03340  9.41e-05  0.608
21    22   0.3170 -3.41000        0.12300  0.02510  3.32e-05  0.482
22    24   0.3330 -3.47000        0.14300  0.01920  1.22e-05  0.386
23    26   0.3660 -3.45000        0.19400  0.01490  4.49e-06  0.316
24    28   0.3340 -3.47000        0.16600  0.01170  1.66e-06  0.260
25    30   0.3470 -3.38000        0.17700  0.00933  5.87e-07  0.216</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">1</span>], <span class="sc">-</span><span class="fu">sign</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">3</span>]) <span class="sc">*</span> sft<span class="sc">$</span>fitIndices[, <span class="dv">2</span>],</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Soft Threshold (power)"</span>,</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Scale Free Topology Model Fit, signed R^2"</span>,</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Scale Independence"</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">1</span>], <span class="sc">-</span><span class="fu">sign</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">3</span>]) <span class="sc">*</span> sft<span class="sc">$</span>fitIndices[, <span class="dv">2</span>],</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> powers, <span class="at">cex =</span> <span class="fl">0.9</span>, <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.90</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">1</span>], sft<span class="sc">$</span>fitIndices[, <span class="dv">5</span>],</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Soft Threshold (power)"</span>,</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Mean Connectivity"</span>,</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Mean Connectivity"</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(sft<span class="sc">$</span>fitIndices[, <span class="dv">1</span>], sft<span class="sc">$</span>fitIndices[, <span class="dv">5</span>], <span class="at">labels =</span> sft<span class="sc">$</span>fitIndices[, <span class="dv">1</span>], <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/wgcna-soft-threshold-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>adj1.all <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cor</span>(rprotblds.std))<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>TOM.dissimilarity <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">TOMsimilarity</span>(adj1.all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>..connectivity..
..matrix multiplication (system BLAS)..
..normalization..
..done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(TOM.dissimilarity) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rprotblds.std)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>hierADJ <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">as.dist</span>(TOM.dissimilarity), <span class="at">method =</span> <span class="st">'complete'</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>Modules <span class="ot">&lt;-</span> <span class="fu">cutreeDynamic</span>(</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dendro =</span> hierADJ,</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">distM =</span> TOM.dissimilarity,</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">deepSplit =</span> <span class="dv">2</span>,</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pamRespectsDendro =</span> <span class="cn">FALSE</span>,</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">minClusterSize =</span> <span class="dv">6</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ..cutHeight not given, setting it to 0.996  ===&gt;  99% of the (truncated) height range in dendro.
 ..done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>ModuleColors <span class="ot">&lt;-</span> <span class="fu">labels2colors</span>(Modules)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Module Sizes:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Module Sizes:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(ModuleColors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ModuleColors
     blue     brown     green      grey turquoise    yellow 
       21        13         8         5        35        10 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDendroAndColors</span>(hierADJ, ModuleColors, <span class="st">"Module"</span>,</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dendroLabels =</span> <span class="cn">NULL</span>,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.dendroLabels =</span> <span class="fl">0.5</span>,</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addGuide =</span> <span class="cn">FALSE</span>,</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Protein Dendrogram with Module Colors"</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/wgcna-dendrogram-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>MElist <span class="ot">&lt;-</span> <span class="fu">moduleEigengenes</span>(<span class="fu">as.data.frame</span>(rprotblds.std), <span class="at">colors =</span> ModuleColors)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>MEs <span class="ot">&lt;-</span> MElist<span class="sc">$</span>eigengenes</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>MEs0 <span class="ot">&lt;-</span> <span class="fu">orderMEs</span>(MEs)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>ID <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>subject_id[<span class="sc">-</span>naset]</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>age <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>age[<span class="sc">-</span>naset]</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(rprotblds<span class="sc">$</span>sex[<span class="sc">-</span>naset]) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>bl_smw <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>bl_smw[<span class="sc">-</span>naset]</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>fu_smw <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>fu_smw[<span class="sc">-</span>naset]</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>chg_smw <span class="ot">&lt;-</span> MEs0<span class="sc">$</span>fu_smw <span class="sc">-</span> MEs0<span class="sc">$</span>bl_smw</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>bl_sppb <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>bl_sppb[<span class="sc">-</span>naset]</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>fu_sppb <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>fu_sppb[<span class="sc">-</span>naset]</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>chg_sppb <span class="ot">&lt;-</span> MEs0<span class="sc">$</span>fu_sppb <span class="sc">-</span> MEs0<span class="sc">$</span>bl_sppb</span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>MEs0<span class="sc">$</span>treatment <span class="ot">&lt;-</span> rprotblds<span class="sc">$</span>intervention_1_control_0[<span class="sc">-</span>naset]</span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">cor</span>(MEs0[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(MEs0) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"treatment"</span>))], <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>))</span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[(df<span class="sc">$</span>Var1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'age'</span>, <span class="st">'bl_smw'</span>, <span class="st">'chg_smw'</span>, <span class="st">'bl_sppb'</span>, <span class="st">'chg_sppb'</span>, <span class="st">'sex'</span>)), ]</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[(df<span class="sc">$</span>Var2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'MEturquoise'</span>, <span class="st">'MEbrown'</span>, <span class="st">'MEyellow'</span>, <span class="st">'MEblue'</span>, <span class="st">'MEgreen'</span>)), ]</span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)) {</span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>Var1[i])</span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>Var2[i])</span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>pval[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a>    MEs0[, <span class="fu">which</span>(<span class="fu">colnames</span>(MEs0) <span class="sc">%in%</span> b1)],</span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a>    MEs0[, <span class="fu">which</span>(<span class="fu">colnames</span>(MEs0) <span class="sc">%in%</span> b2)],</span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span></span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>p.value</span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sig <span class="ot">&lt;-</span> df<span class="sc">$</span>pval <span class="sc">&lt;</span> <span class="fl">0.01</span></span>
<span id="cb207-34"><a href="#cb207-34" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb207-35"><a href="#cb207-35" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>sig <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> df<span class="sc">$</span>value <span class="sc">!=</span> <span class="dv">1</span>,</span>
<span id="cb207-36"><a href="#cb207-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="fu">round</span>(df<span class="sc">$</span>value, <span class="dv">3</span>), <span class="st">"*"</span>),</span>
<span id="cb207-37"><a href="#cb207-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(df<span class="sc">$</span>value, <span class="dv">3</span>)</span>
<span id="cb207-38"><a href="#cb207-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var2, Var1, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Pearson</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(Var2, Var1, <span class="at">label =</span> text), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span></span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">barwidth =</span> <span class="dv">15</span>, <span class="at">barheight =</span> <span class="dv">1</span>,</span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">"top"</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span></span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Module Eigengene Correlations with Clinical Variables"</span>) <span class="sc">+</span></span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present.
ℹ Adding new coordinate system, which will replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="REHAB-HF_proteomicsanalysis010726_markdown_files/figure-html/wgcna-heatmap-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Top 5 Proteins per Module ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Top 5 Proteins per Module ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>n_modules <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(MEs0) <span class="sc">==</span> <span class="st">"ID"</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_modules) {</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  clr <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">names</span>(MEs0)[<span class="dv">1</span><span class="sc">:</span>n_modules],</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">function</span>(x) <span class="fu">substring</span>(x, <span class="dv">3</span>, <span class="fu">nchar</span>(x)))[i]</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  geneModuleMembership <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(rprotblds.std[, ModuleColors <span class="sc">==</span> clr], MEs0[, i], <span class="at">use =</span> <span class="st">"p"</span>)</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  mm_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"MM"</span>, <span class="fu">substring</span>(<span class="fu">names</span>(MEs0)[i], <span class="dv">3</span>))</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(geneModuleMembership) <span class="ot">&lt;-</span> mm_name</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get top 5 proteins</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>  top5 <span class="ot">&lt;-</span> geneModuleMembership[</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">order</span>(geneModuleMembership[, <span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], , drop <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create consistent dataframe structure</span></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>  top5_clean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Module =</span> clr,</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Protein =</span> <span class="fu">rownames</span>(top5),</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ModuleMembership =</span> top5[[<span class="dv">1</span>]],  <span class="co"># Extract the numeric column</span></span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">NULL</span>,</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>  results_list[[i]] <span class="ot">&lt;-</span> top5_clean</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all results using bind_rows (more robust than do.call)</span></span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_list)</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print with kable</span></span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>  all_results, </span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Top 5 Proteins per Module"</span>,</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Module"</span>, <span class="st">"Protein"</span>, <span class="st">"Module Membership"</span>)</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Proteins per Module</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Module</th>
<th style="text-align: left;">Protein</th>
<th style="text-align: right;">Module Membership</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">green</td>
<td style="text-align: left;">MMP-9</td>
<td style="text-align: right;">0.8874</td>
</tr>
<tr class="even">
<td style="text-align: left;">green</td>
<td style="text-align: left;">AZU1</td>
<td style="text-align: right;">0.7866</td>
</tr>
<tr class="odd">
<td style="text-align: left;">green</td>
<td style="text-align: left;">PRTN3</td>
<td style="text-align: right;">0.7693</td>
</tr>
<tr class="even">
<td style="text-align: left;">green</td>
<td style="text-align: left;">MPO</td>
<td style="text-align: right;">0.7478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">green</td>
<td style="text-align: left;">PAI</td>
<td style="text-align: right;">0.6709</td>
</tr>
<tr class="even">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">Notch 3</td>
<td style="text-align: right;">0.7981</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">IGFBP-7</td>
<td style="text-align: right;">0.7922</td>
</tr>
<tr class="even">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">ALCAM</td>
<td style="text-align: right;">0.7899</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">CDH5</td>
<td style="text-align: right;">0.7687</td>
</tr>
<tr class="even">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">IL-1RT1</td>
<td style="text-align: right;">0.7648</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellow</td>
<td style="text-align: left;">IGFBP-2</td>
<td style="text-align: right;">0.8076</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellow</td>
<td style="text-align: left;">OPN</td>
<td style="text-align: right;">0.7491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellow</td>
<td style="text-align: left;">AXL</td>
<td style="text-align: right;">0.7180</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellow</td>
<td style="text-align: left;">SHPS-1</td>
<td style="text-align: right;">0.7127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellow</td>
<td style="text-align: left;">IGFBP-1</td>
<td style="text-align: right;">0.6821</td>
</tr>
<tr class="even">
<td style="text-align: left;">brown</td>
<td style="text-align: left;">CSTB</td>
<td style="text-align: right;">0.8913</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brown</td>
<td style="text-align: left;">U-PAR</td>
<td style="text-align: right;">0.8406</td>
</tr>
<tr class="even">
<td style="text-align: left;">brown</td>
<td style="text-align: left;">JAM-A</td>
<td style="text-align: right;">0.8195</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brown</td>
<td style="text-align: left;">TFF3</td>
<td style="text-align: right;">0.7498</td>
</tr>
<tr class="even">
<td style="text-align: left;">brown</td>
<td style="text-align: left;">FABP4</td>
<td style="text-align: right;">0.7482</td>
</tr>
<tr class="odd">
<td style="text-align: left;">turquoise</td>
<td style="text-align: left;">EPHB4</td>
<td style="text-align: right;">0.9363</td>
</tr>
<tr class="even">
<td style="text-align: left;">turquoise</td>
<td style="text-align: left;">TNF-R1</td>
<td style="text-align: right;">0.9351</td>
</tr>
<tr class="odd">
<td style="text-align: left;">turquoise</td>
<td style="text-align: left;">LTBR</td>
<td style="text-align: right;">0.9242</td>
</tr>
<tr class="even">
<td style="text-align: left;">turquoise</td>
<td style="text-align: left;">TNFRSF14</td>
<td style="text-align: right;">0.9204</td>
</tr>
<tr class="odd">
<td style="text-align: left;">turquoise</td>
<td style="text-align: left;">IL-18BP</td>
<td style="text-align: right;">0.8733</td>
</tr>
<tr class="even">
<td style="text-align: left;">grey</td>
<td style="text-align: left;">PON3</td>
<td style="text-align: right;">0.7093</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grey</td>
<td style="text-align: left;">Ep-CAM</td>
<td style="text-align: right;">0.6048</td>
</tr>
<tr class="even">
<td style="text-align: left;">grey</td>
<td style="text-align: left;">CCL24</td>
<td style="text-align: right;">0.4790</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grey</td>
<td style="text-align: left;">t-PA</td>
<td style="text-align: right;">-0.1800</td>
</tr>
<tr class="even">
<td style="text-align: left;">grey</td>
<td style="text-align: left;">CPA1</td>
<td style="text-align: right;">-0.1997</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="module-treatment-interactions" class="level2">
<h2 class="anchored" data-anchor-id="module-treatment-interactions">Module-Treatment Interactions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SPPB Outcomes</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SPPB Outcomes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=============</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=============</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data =</span> MEs0, <span class="at">formula =</span> fu_sppb <span class="sc">~</span> bl_sppb <span class="sc">+</span> MEturquoise <span class="sc">*</span> treatment)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fu_sppb ~ bl_sppb + MEturquoise * treatment, data = MEs0)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.1556 -1.3491  0.3993  1.8797  5.2605 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             2.28849    0.52762   4.337  2.3e-05 ***
bl_sppb                 0.70709    0.07248   9.756  &lt; 2e-16 ***
MEturquoise            -6.27205    4.35906  -1.439 0.151779    
treatment1              1.41930    0.36754   3.862 0.000153 ***
MEturquoise:treatment1  2.31193    5.68193   0.407 0.684529    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.605 on 197 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.3972,    Adjusted R-squared:  0.385 
F-statistic: 32.46 on 4 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">6MWD Outcomes</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
6MWD Outcomes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=============</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=============</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data =</span> MEs0, <span class="at">formula =</span> fu_smw <span class="sc">~</span> bl_smw <span class="sc">+</span> MEturquoise <span class="sc">*</span> treatment)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fu_smw ~ bl_smw + MEturquoise * treatment, data = MEs0)

Residuals:
    Min      1Q  Median      3Q     Max 
-263.24  -56.13    1.88   55.82  531.28 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              86.78248   16.95734   5.118 8.43e-07 ***
bl_smw                    0.80907    0.06599  12.261  &lt; 2e-16 ***
MEturquoise            -356.50951  175.54876  -2.031   0.0439 *  
treatment1               36.67628   13.77237   2.663   0.0085 ** 
MEturquoise:treatment1  202.10817  220.65888   0.916   0.3610    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 89.59 on 167 degrees of freedom
  (60 observations deleted due to missingness)
Multiple R-squared:  0.5392,    Adjusted R-squared:  0.5282 
F-statistic: 48.86 on 4 and 167 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="secondary-outcomes" class="level1">
<h1>Secondary Outcomes</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_summary</span>(rprotblds[, <span class="fu">c</span>(<span class="st">"intervention_1_control_0"</span>, <span class="st">"event"</span>, <span class="st">"rehosp"</span>, <span class="st">"death"</span>, <span class="st">"lfu"</span>)],</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> intervention_1_control_0,</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"continuous2"</span>),</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">c</span>(<span class="st">"{mean} ({sd})"</span>, <span class="st">"{median} ({p25}, {p75})"</span>, <span class="st">"{min}, {max}"</span>),</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} / {N} ({p}%)"</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>    rehosp <span class="sc">~</span> <span class="st">"Rehospitalization"</span>,</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>    death <span class="sc">~</span> <span class="st">"Death"</span>,</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>    event <span class="sc">~</span> <span class="st">"Rehospitalization or Death"</span>,</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>    lfu <span class="sc">~</span> <span class="st">"Lost to follow up"</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing_text =</span> <span class="st">"(Missing)"</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>(<span class="fu">list</span>(</span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"wilcox.test"</span>,</span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"fisher.test"</span></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_n</span>() <span class="sc">%&gt;%</span></span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">"**Variable**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Secondary Outcomes**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_spanning_header</span>(<span class="fu">c</span>(<span class="st">"stat_1"</span>, <span class="st">"stat_2"</span>) <span class="sc">~</span> <span class="st">"**Control (0) vs. Intervention (1)**"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="gcyjougpct" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gcyjougpct table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gcyjougpct thead, #gcyjougpct tbody, #gcyjougpct tfoot, #gcyjougpct tr, #gcyjougpct td, #gcyjougpct th {
  border-style: none;
}

#gcyjougpct p {
  margin: 0;
  padding: 0;
}

#gcyjougpct .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gcyjougpct .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gcyjougpct .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gcyjougpct .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gcyjougpct .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcyjougpct .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcyjougpct .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcyjougpct .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gcyjougpct .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gcyjougpct .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gcyjougpct .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gcyjougpct .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gcyjougpct .gt_spanner_row {
  border-bottom-style: hidden;
}

#gcyjougpct .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gcyjougpct .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gcyjougpct .gt_from_md > :first-child {
  margin-top: 0;
}

#gcyjougpct .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gcyjougpct .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gcyjougpct .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gcyjougpct .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gcyjougpct .gt_row_group_first td {
  border-top-width: 2px;
}

#gcyjougpct .gt_row_group_first th {
  border-top-width: 2px;
}

#gcyjougpct .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcyjougpct .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gcyjougpct .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gcyjougpct .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcyjougpct .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcyjougpct .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gcyjougpct .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gcyjougpct .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gcyjougpct .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcyjougpct .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcyjougpct .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcyjougpct .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcyjougpct .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcyjougpct .gt_left {
  text-align: left;
}

#gcyjougpct .gt_center {
  text-align: center;
}

#gcyjougpct .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gcyjougpct .gt_font_normal {
  font-weight: normal;
}

#gcyjougpct .gt_font_bold {
  font-weight: bold;
}

#gcyjougpct .gt_font_italic {
  font-style: italic;
}

#gcyjougpct .gt_super {
  font-size: 65%;
}

#gcyjougpct .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gcyjougpct .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gcyjougpct .gt_indent_1 {
  text-indent: 5px;
}

#gcyjougpct .gt_indent_2 {
  text-indent: 10px;
}

#gcyjougpct .gt_indent_3 {
  text-indent: 15px;
}

#gcyjougpct .gt_indent_4 {
  text-indent: 20px;
}

#gcyjougpct .gt_indent_5 {
  text-indent: 25px;
}

#gcyjougpct .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gcyjougpct div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Secondary Outcomes</strong></caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variable</strong></th>
<th rowspan="2" id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N</strong></th>
<th colspan="2" id="**Control (0) vs. Intervention (1)**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Control (0) vs.&nbsp;Intervention (1)</strong>
</div></th>
<th rowspan="2" id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>0</strong><br> N = 113<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>1</strong><br> N = 130<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Rehospitalization or Death</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1">70 / 113 (62%)</td>
<td class="gt_row gt_center" headers="stat_2">75 / 130 (58%)</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Rehospitalization</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1">68 / 113 (60%)</td>
<td class="gt_row gt_center" headers="stat_2">72 / 130 (55%)</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Death</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1">12 / 113 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">16 / 130 (12%)</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Lost to follow up</td>
<td class="gt_row gt_center" headers="n">243</td>
<td class="gt_row gt_center" headers="stat_1">7 / 113 (6.2%)</td>
<td class="gt_row gt_center" headers="stat_2">9 / 130 (6.9%)</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n / N (%)</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Fisher’s exact test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="session-summary" class="level1">
<h1>Session Summary</h1>
<section id="study-population-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="study-population-characteristics">Study Population Characteristics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Study Population Summary</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Study Population Summary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"========================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>========================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total REHAB-HF enrolled:"</span>, <span class="fu">nrow</span>(rhfds), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total REHAB-HF enrolled: 349 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"With baseline proteomics:"</span>, <span class="fu">nrow</span>(rprotblds), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>With baseline proteomics: 243 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Baseline and Follow-up SPPB:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Baseline and Follow-up SPPB:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>n_sppb <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rhfds[rhfds<span class="sc">$</span>study_id <span class="sc">%in%</span> rprotblds<span class="sc">$</span>subject_id <span class="sc">&amp;</span> </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">!</span><span class="fu">is.na</span>(rhfds<span class="sc">$</span>fu_sppb) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rhfds<span class="sc">$</span>bl_sppb), ])</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  -"</span>, n_sppb, <span class="st">"subjects</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - 213 subjects</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Baseline and Follow-up 6MWD:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Baseline and Follow-up 6MWD:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>n_6mwd <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rhfds[rhfds<span class="sc">$</span>study_id <span class="sc">%in%</span> rprotblds<span class="sc">$</span>subject_id <span class="sc">&amp;</span> </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">!</span><span class="fu">is.na</span>(rhfds<span class="sc">$</span>fu_smw) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rhfds<span class="sc">$</span>bl_smw), ])</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  -"</span>, n_6mwd, <span class="st">"subjects</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - 181 subjects</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Intervention Groups (analyzed cohort):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Intervention Groups (analyzed cohort):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>n_control <span class="ot">&lt;-</span> <span class="fu">sum</span>(rprotblds<span class="sc">$</span>intervention_1_control_0 <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>n_interv <span class="ot">&lt;-</span> <span class="fu">sum</span>(rprotblds<span class="sc">$</span>intervention_1_control_0 <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Attention Control:"</span>, n_control, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Attention Control: 113 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Rehabilitation Intervention:"</span>, n_interv, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Rehabilitation Intervention: 130 </code></pre>
</div>
</div>
</section>
<section id="baseline-characteristics-summary" class="level2">
<h2 class="anchored" data-anchor-id="baseline-characteristics-summary">Baseline Characteristics Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Age (years):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Age (years):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tapply</span>(rprotblds<span class="sc">$</span>age, rprotblds<span class="sc">$</span>intervention_1_control_0, </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>             <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Median =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
     Mean        SD    Median 
72.418286  7.736805 72.327456 

$`1`
    Mean       SD   Median 
72.53751  8.30611 72.33414 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Baseline SPPB Score:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Baseline SPPB Score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tapply</span>(rprotblds<span class="sc">$</span>bl_sppb, rprotblds<span class="sc">$</span>intervention_1_control_0,</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>             <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Median =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
    Mean       SD   Median 
6.150442 2.578140 6.000000 

$`1`
    Mean       SD   Median 
6.069231 2.739854 6.000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Baseline 6MWD (meters):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Baseline 6MWD (meters):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tapply</span>(rprotblds<span class="sc">$</span>bl_smw, rprotblds<span class="sc">$</span>intervention_1_control_0,</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>             <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Median =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
    Mean       SD   Median 
193.9112 108.5218 175.0000 

$`1`
    Mean       SD   Median 
200.1188 108.2644 188.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Baseline eGFR:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Baseline eGFR:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tapply</span>(rprotblds<span class="sc">$</span>egfr, rprotblds<span class="sc">$</span>intervention_1_control_0,</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>             <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Median =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
    Mean       SD   Median 
55.79911 22.91560 56.71452 

$`1`
    Mean       SD   Median 
52.62689 21.85924 48.59929 </code></pre>
</div>
</div>
</section>
<section id="analysis-parameters" class="level2">
<h2 class="anchored" data-anchor-id="analysis-parameters">Analysis Parameters</h2>
<ul>
<li><strong>Soft-thresholding power (WGCNA):</strong> 4</li>
<li><strong>WGCNA module detection sensitivity (deepSplit):</strong> 2</li>
<li><strong>Minimum module size:</strong> 6 proteins</li>
<li><strong>Propensity score matching caliper:</strong> 1 SD of protein values</li>
<li><strong>Matching tree parameters:</strong> minbucket 15-30, maxdepth 1-2</li>
<li><strong>Cross-validation folds:</strong> 10</li>
<li><strong>BART model:</strong> 100 trees, 2000 burn-in, 2000 post-burn-in iterations</li>
<li><strong>Mediation analysis:</strong> 1000 bootstrap samples</li>
</ul>
</section>
<section id="missing-data-handling" class="level2">
<h2 class="anchored" data-anchor-id="missing-data-handling">Missing Data Handling</h2>
<ul>
<li><strong>Negative protein values:</strong> Replaced with NA</li>
<li><strong>Baseline biomarker outliers (&gt;3 SD on log2 scale):</strong> Set to NA</li>
<li><strong>Censored values:</strong>
<ul>
<li>Left-censored (below LOD): Imputed as LOD/2</li>
<li>Right-censored (above ULD): Imputed as ULD</li>
</ul></li>
<li><strong>QNS (Quantity Not Sufficient):</strong> Replaced with NA</li>
</ul>
</section>
<section id="significance-levels" class="level2">
<h2 class="anchored" data-anchor-id="significance-levels">Significance Levels</h2>
<ul>
<li><strong>Primary analyses:</strong> p &lt; 0.05 (unadjusted)</li>
<li><strong>Protein correlations:</strong> p &lt; 0.01 (indicated with asterisk)</li>
<li><strong>Module-outcome correlations:</strong> p &lt; 0.01 (indicated with asterisk)</li>
<li><strong>Effect modification screening:</strong> FDR-adjusted</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
